var documenterSearchIndex = {"docs":
[{"location":"examples/multiprocessing/#Manipulate-a-function","page":"Manipulate a function","title":"Manipulate a function","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Tutorial by Jonas Wilfert, Tobias Thummerer","category":"page"},{"location":"examples/multiprocessing/#License","page":"Manipulate a function","title":"License","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Copyright (c) 2021 Tobias Thummerer, Lars Mikelsons, Josef Kircher, Johannes Stoljar, Jonas Wilfert","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Licensed under the MIT license. See LICENSE file in the project root for details.","category":"page"},{"location":"examples/multiprocessing/#Motivation","page":"Manipulate a function","title":"Motivation","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"This Julia Package FMI.jl is motivated by the use of simulation models in Julia. Here the FMI specification is implemented. FMI (Functional Mock-up Interface) is a free standard (fmi-standard.org) that defines a container and an interface to exchange dynamic models using a combination of XML files, binaries and C code zipped into a single file. The user can thus use simulation models in the form of an FMU (Functional Mock-up Units). Besides loading the FMU, the user can also set values for parameters and states and simulate the FMU both as co-simulation and model exchange simulation.","category":"page"},{"location":"examples/multiprocessing/#Introduction-to-the-example","page":"Manipulate a function","title":"Introduction to the example","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"This example shows how to parallelize the computation of an FMU in FMI.jl. We can compute a batch of FMU-evaluations in parallel with different initial settings. Parallelization can be achieved using multithreading or using multiprocessing. This example shows multiprocessing, check multithreading.ipynb for multithreading. Advantage of multithreading is a lower communication overhead as well as lower RAM usage. However in some cases multiprocessing can be faster as the garbage collector is not shared.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"The model used is a one-dimensional spring pendulum with friction. The object-orientated structure of the SpringFrictionPendulum1D can be seen in the following graphic.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"(Image: svg)  ","category":"page"},{"location":"examples/multiprocessing/#Target-group","page":"Manipulate a function","title":"Target group","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"The example is primarily intended for users who work in the field of simulations. The example wants to show how simple it is to use FMUs in Julia.","category":"page"},{"location":"examples/multiprocessing/#Other-formats","page":"Manipulate a function","title":"Other formats","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Besides, this Jupyter Notebook there is also a Julia file with the same name, which contains only the code cells and for the documentation there is a Markdown file corresponding to the notebook.  ","category":"page"},{"location":"examples/multiprocessing/#Getting-started","page":"Manipulate a function","title":"Getting started","text":"","category":"section"},{"location":"examples/multiprocessing/#Installation-prerequisites","page":"Manipulate a function","title":"Installation prerequisites","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":" Description Command Alternative\n1. Enter Package Manager via ] \n2. Install FMI via add FMI add \" https://github.com/ThummeTo/FMI.jl \"\n3. Install FMIZoo via add FMIZoo add \" https://github.com/ThummeTo/FMIZoo.jl \"\n4. Install FMICore via add FMICore add \" https://github.com/ThummeTo/FMICore.jl \"\n5. Install BenchmarkTools via add BenchmarkTools ","category":"page"},{"location":"examples/multiprocessing/#Code-section","page":"Manipulate a function","title":"Code section","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Adding your desired amount of processes:","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"using Distributed\nn_procs = 4\naddprocs(n_procs; exeflags=`--project=$(Base.active_project()) --threads=auto`, restrict=false)","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"4-element Vector{Int64}:\n 2\n 3\n 4\n 5","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"To run the example, the previously installed packages must be included. ","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"# imports\n@everywhere using FMI\n@everywhere using FMIZoo\n@everywhere using BenchmarkTools","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Checking that we workers have been correctly initialized:","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"workers()\n\n@everywhere println(\"Hello World!\")\n\n# The following lines can be uncommented for more advanced informations about the subprocesses\n# @everywhere println(pwd())\n# @everywhere println(Base.active_project())\n# @everywhere println(gethostname())\n# @everywhere println(VERSION)\n# @everywhere println(Threads.nthreads())","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Hello World!\n      From worker 3:\tHello World!\n      From worker 5:\tHello World!\n      From worker 4:\tHello World!\n      From worker 2:\tHello World!","category":"page"},{"location":"examples/multiprocessing/#Simulation-setup","page":"Manipulate a function","title":"Simulation setup","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Next, the batch size and input values are defined.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"\n# Best if batchSize is a multiple of the threads/cores\nbatchSize = 16\n\n# Define an array of arrays randomly\ninput_values = collect(collect.(eachrow(rand(batchSize,2))))","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"16-element Vector{Vector{Float64}}:\n [0.2714604490706656, 0.6564347517330724]\n [0.6045701521373479, 0.8598277454128023]\n [0.5386312373993718, 0.33415179305733766]\n [0.1024068715709443, 0.2020368936863015]\n [0.6589648171354268, 0.8785037039616077]\n [0.08601536809198129, 0.2687409689391873]\n [0.13067481159527983, 0.33632379301506954]\n [0.6999742605423405, 0.10068323741970886]\n [0.9540670320620026, 0.9686049140961277]\n [0.2612944204954577, 0.9837595553991252]\n [0.8685780293236973, 0.18344140780715645]\n [0.21686873971149545, 0.9761901874309866]\n [0.23443540457478873, 0.7705528668488286]\n [0.21074323889064162, 0.8598613657729404]\n [0.7256875230344018, 0.647428549729496]\n [0.5950019216216742, 0.5672654296644193]","category":"page"},{"location":"examples/multiprocessing/#Shared-Module","page":"Manipulate a function","title":"Shared Module","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"For Distributed we need to embed the FMU into its own module. This prevents Distributed from trying to serialize and send the FMU over the network, as this can cause issues. This module needs to be made available on all processes using @everywhere.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"@everywhere module SharedModule\n    using FMIZoo\n    using FMI\n\n    t_start = 0.0\n    t_step = 0.1\n    t_stop = 10.0\n    tspan = (t_start, t_stop)\n    tData = collect(t_start:t_step:t_stop)\n\n    model_fmu = FMIZoo.fmiLoad(\"SpringPendulum1D\", \"Dymola\", \"2022x\")\nend","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"┌ Info: fmi2Unzip(...): Successfully unzipped 153 files at `/tmp/fmijl_EtEfX5/SpringPendulum1D`.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/gTZB4/src/FMI2_ext.jl:76\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Unzip(...): Successfully unzipped 153 files at `/tmp/fmijl_B3tLyY/SpringPendulum1D`.\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Unzip(...): Successfully unzipped 153 files at `/tmp/fmijl_fpDd7f/SpringPendulum1D`.\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Unzip(...): Successfully unzipped 153 files at `/tmp/fmijl_tce8Ya/SpringPendulum1D`.\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Unzip(...): Successfully unzipped 153 files at `/tmp/fmijl_xvuln9/SpringPendulum1D`.\n┌ Info: fmi2Load(...): FMU resources location is `file:////tmp/fmijl_EtEfX5/SpringPendulum1D/resources`\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/gTZB4/src/FMI2_ext.jl:192\n┌ Info: fmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/gTZB4/src/FMI2_ext.jl:195\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Load(...): FMU resources location is `file:////tmp/fmijl_B3tLyY/SpringPendulum1D/resources`\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Load(...): FMU resources location is `file:////tmp/fmijl_fpDd7f/SpringPendulum1D/resources`\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Load(...): FMU resources location is `file:////tmp/fmijl_xvuln9/SpringPendulum1D/resources`\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Load(...): FMU resources location is `file:////tmp/fmijl_tce8Ya/SpringPendulum1D/resources`\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mfmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"We define a helper function to calculate the FMU and combine it into an Matrix.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"@everywhere function runCalcFormatted(fmu, x0, recordValues=[\"mass.s\", \"mass.v\"])\n    data = fmiSimulateME(fmu, SharedModule.t_start, SharedModule.t_stop; recordValues=recordValues, saveat=SharedModule.tData, x0=x0, showProgress=false, dtmax=1e-4)\n    return reduce(hcat, data.states.u)\nend","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Running a single evaluation is pretty quick, therefore the speed can be better tested with BenchmarkTools.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"@benchmark data = runCalcFormatted(SharedModule.model_fmu, rand(2))","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"BenchmarkTools.Trial: 17 samples with 1 evaluation.\n Range \u001b[90m(\u001b[39m\u001b[36m\u001b[1mmin\u001b[22m\u001b[39m … \u001b[35mmax\u001b[39m\u001b[90m):  \u001b[39m\u001b[36m\u001b[1m301.638 ms\u001b[22m\u001b[39m … \u001b[35m319.786 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmin … max\u001b[90m): \u001b[39m4.70% … 4.41%\n Time  \u001b[90m(\u001b[39m\u001b[34m\u001b[1mmedian\u001b[22m\u001b[39m\u001b[90m):     \u001b[39m\u001b[34m\u001b[1m305.161 ms               \u001b[22m\u001b[39m\u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmedian\u001b[90m):    \u001b[39m4.69%\n Time  \u001b[90m(\u001b[39m\u001b[32m\u001b[1mmean\u001b[22m\u001b[39m ± \u001b[32mσ\u001b[39m\u001b[90m):   \u001b[39m\u001b[32m\u001b[1m306.708 ms\u001b[22m\u001b[39m ± \u001b[32m  4.570 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmean ± σ\u001b[90m):  \u001b[39m5.09% ± 0.89%\n\n  \u001b[39m \u001b[39m \u001b[39m \u001b[39m▃\u001b[39m \u001b[39m \u001b[39m \u001b[39m█\u001b[34m \u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[32m \u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m▃\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \n  \u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m█\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m█\u001b[34m▇\u001b[39m\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[32m▁\u001b[39m\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m█\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m \u001b[39m▁\n  302 ms\u001b[90m           Histogram: frequency by time\u001b[39m          320 ms \u001b[0m\u001b[1m<\u001b[22m\n\n Memory estimate\u001b[90m: \u001b[39m\u001b[33m146.80 MiB\u001b[39m, allocs estimate\u001b[90m: \u001b[39m\u001b[33m3002431\u001b[39m.","category":"page"},{"location":"examples/multiprocessing/#Single-Threaded-Batch-Execution","page":"Manipulate a function","title":"Single Threaded Batch Execution","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"To compute a batch we can collect multiple evaluations. In a single threaded context we can use the same FMU for every call.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"println(\"Single Threaded\")\n@benchmark collect(runCalcFormatted(SharedModule.model_fmu, i) for i in input_values)","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Single Threaded\n\n\n\n\n\nBenchmarkTools.Trial: 2 samples with 1 evaluation.\n Range \u001b[90m(\u001b[39m\u001b[36m\u001b[1mmin\u001b[22m\u001b[39m … \u001b[35mmax\u001b[39m\u001b[90m):  \u001b[39m\u001b[36m\u001b[1m4.918 s\u001b[22m\u001b[39m … \u001b[35m 4.922 s\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmin … max\u001b[90m): \u001b[39m5.47% … 5.19%\n Time  \u001b[90m(\u001b[39m\u001b[34m\u001b[1mmedian\u001b[22m\u001b[39m\u001b[90m):     \u001b[39m\u001b[34m\u001b[1m4.920 s             \u001b[22m\u001b[39m\u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmedian\u001b[90m):    \u001b[39m5.33%\n Time  \u001b[90m(\u001b[39m\u001b[32m\u001b[1mmean\u001b[22m\u001b[39m ± \u001b[32mσ\u001b[39m\u001b[90m):   \u001b[39m\u001b[32m\u001b[1m4.920 s\u001b[22m\u001b[39m ± \u001b[32m2.353 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmean ± σ\u001b[90m):  \u001b[39m5.33% ± 0.19%\n\n  \u001b[34m█\u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[32m \u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m█\u001b[39m \u001b[39m \n  \u001b[34m█\u001b[39m\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[32m▁\u001b[39m\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m█\u001b[39m \u001b[39m▁\n  4.92 s\u001b[90m        Histogram: frequency by time\u001b[39m        4.92 s \u001b[0m\u001b[1m<\u001b[22m\n\n Memory estimate\u001b[90m: \u001b[39m\u001b[33m2.29 GiB\u001b[39m, allocs estimate\u001b[90m: \u001b[39m\u001b[33m48038884\u001b[39m.","category":"page"},{"location":"examples/multiprocessing/#Multithreaded-Batch-Execution","page":"Manipulate a function","title":"Multithreaded Batch Execution","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"In a multithreaded context we have to provide each thread it's own fmu, as they are not thread safe. To spread the execution of a function to multiple processes, the function pmap can be used.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"println(\"Multi Threaded\")\n@benchmark pmap(i -> runCalcFormatted(SharedModule.model_fmu, i), input_values)","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"Multi Threaded\n\n\n\n\n\nBenchmarkTools.Trial: 2 samples with 1 evaluation.\n Range \u001b[90m(\u001b[39m\u001b[36m\u001b[1mmin\u001b[22m\u001b[39m … \u001b[35mmax\u001b[39m\u001b[90m):  \u001b[39m\u001b[36m\u001b[1m2.963 s\u001b[22m\u001b[39m … \u001b[35m  2.989 s\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmin … max\u001b[90m): \u001b[39m0.00% … 0.00%\n Time  \u001b[90m(\u001b[39m\u001b[34m\u001b[1mmedian\u001b[22m\u001b[39m\u001b[90m):     \u001b[39m\u001b[34m\u001b[1m2.976 s              \u001b[22m\u001b[39m\u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmedian\u001b[90m):    \u001b[39m0.00%\n Time  \u001b[90m(\u001b[39m\u001b[32m\u001b[1mmean\u001b[22m\u001b[39m ± \u001b[32mσ\u001b[39m\u001b[90m):   \u001b[39m\u001b[32m\u001b[1m2.976 s\u001b[22m\u001b[39m ± \u001b[32m18.030 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmean ± σ\u001b[90m):  \u001b[39m0.00% ± 0.00%\n\n  \u001b[34m█\u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[32m \u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m█\u001b[39m \u001b[39m \n  \u001b[34m█\u001b[39m\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[32m▁\u001b[39m\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m█\u001b[39m \u001b[39m▁\n  2.96 s\u001b[90m         Histogram: frequency by time\u001b[39m        2.99 s \u001b[0m\u001b[1m<\u001b[22m\n\n Memory estimate\u001b[90m: \u001b[39m\u001b[33m81.25 KiB\u001b[39m, allocs estimate\u001b[90m: \u001b[39m\u001b[33m1189\u001b[39m.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"As you can see, there is a significant speed-up in the median execution time. But: The speed-up is often much smaller than n_procs (or the number of physical cores of your CPU), this has different reasons. For a rule of thumb, the speed-up should be around n/2 on a n-core-processor with n Julia processes.","category":"page"},{"location":"examples/multiprocessing/#Unload-FMU","page":"Manipulate a function","title":"Unload FMU","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"After calculating the data, the FMU is unloaded and all unpacked data on disc is removed.","category":"page"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"@everywhere fmiUnload(SharedModule.model_fmu)","category":"page"},{"location":"examples/multiprocessing/#Summary","page":"Manipulate a function","title":"Summary","text":"","category":"section"},{"location":"examples/multiprocessing/","page":"Manipulate a function","title":"Manipulate a function","text":"In this tutorial it is shown how multi processing with Distributed.jl can be used to improve the performance for calculating a Batch of FMUs.","category":"page"},{"location":"contents/","page":"Contents","title":"Contents","text":"Depth = 2","category":"page"},{"location":"examples/manipulation/#Manipulate-a-function","page":"Manipulate a function","title":"Manipulate a function","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"Tutorial by Johannes Stoljar, Tobias Thummerer","category":"page"},{"location":"examples/manipulation/#License","page":"Manipulate a function","title":"License","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"Copyright (c) 2021 Tobias Thummerer, Lars Mikelsons, Josef Kircher, Johannes Stoljar","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"Licensed under the MIT license. See LICENSE file in the project root for details.","category":"page"},{"location":"examples/manipulation/#Motivation","page":"Manipulate a function","title":"Motivation","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"This Julia Package FMI.jl is motivated by the use of simulation models in Julia. Here the FMI specification is implemented. FMI (Functional Mock-up Interface) is a free standard (fmi-standard.org) that defines a container and an interface to exchange dynamic models using a combination of XML files, binaries and C code zipped into a single file. The user can thus use simulation models in the form of an FMU (Functional Mock-up Units). Besides loading the FMU, the user can also set values for parameters and states and simulate the FMU both as co-simulation and model exchange simulation.","category":"page"},{"location":"examples/manipulation/#Introduction-to-the-example","page":"Manipulate a function","title":"Introduction to the example","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"This example shows how to overwrite a library function with an own function. For this the FMU model is simulated first without changes. Then the function fmi2GetReal() is overwritten and simulated again. Both simulations are displayed in a graph to show the change caused by overwriting the function. The model used is a one-dimensional spring pendulum with friction. The object-orientated structure of the SpringFrictionPendulum1D can be seen in the following graphic.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"(Image: svg)  ","category":"page"},{"location":"examples/manipulation/#Target-group","page":"Manipulate a function","title":"Target group","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"The example is primarily intended for users who work in the field of simulations. The example wants to show how simple it is to use FMUs in Julia.","category":"page"},{"location":"examples/manipulation/#Other-formats","page":"Manipulate a function","title":"Other formats","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"Besides, this Jupyter Notebook there is also a Julia file with the same name, which contains only the code cells and for the documentation there is a Markdown file corresponding to the notebook.  ","category":"page"},{"location":"examples/manipulation/#Getting-started","page":"Manipulate a function","title":"Getting started","text":"","category":"section"},{"location":"examples/manipulation/#Installation-prerequisites","page":"Manipulate a function","title":"Installation prerequisites","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":" Description Command Alternative\n1. Enter Package Manager via ] \n2. Install FMI via add FMI add \" https://github.com/ThummeTo/FMI.jl \"\n3. Install FMIZoo via add FMIZoo add \" https://github.com/ThummeTo/FMIZoo.jl \"\n4. Install FMICore via add FMICore add \" https://github.com/ThummeTo/FMICore.jl \"\n5. Install Plots via add Plots ","category":"page"},{"location":"examples/manipulation/#Code-section","page":"Manipulate a function","title":"Code section","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"To run the example, the previously installed packages must be included. ","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"# imports\nusing FMI\nusing FMIZoo\nusing FMICore\nusing Plots","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"┌ Warning: Replacing docs for `FMI.fmiPlot :: Tuple{FMU2Solution}` in module `FMI`\n└ @ Base.Docs docs/Docs.jl:240","category":"page"},{"location":"examples/manipulation/#Simulation-setup","page":"Manipulate a function","title":"Simulation setup","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"Next, the start time and end time of the simulation are set.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"tStart = 0.0\ntStop = 8.0","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"8.0","category":"page"},{"location":"examples/manipulation/#Import-FMU","page":"Manipulate a function","title":"Import FMU","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"In the next lines of code the FMU model from FMIZoo.jl is loaded and the information about the FMU is shown.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"# we use an FMU from the FMIZoo.jl\npathToFMU = get_model_filename(\"SpringFrictionPendulum1D\", \"Dymola\", \"2022x\")\n\nmyFMU = fmiLoad(pathToFMU)\n\nfmiInfo(myFMU)","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"┌ Info: fmi2Unzip(...): Successfully unzipped 29 files at `/tmp/fmijl_AxClYk/SpringFrictionPendulum1D`.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:75\n┌ Info: fmi2Load(...): FMU resources location is `file:////tmp/fmijl_AxClYk/SpringFrictionPendulum1D/resources`\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:190\n┌ Info: fmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:193\n\n\n#################### Begin information for FMU ####################\n\tModel name:\t\t\tSpringFrictionPendulum1D\n\tFMI-Version:\t\t\t2.0\n\tGUID:\t\t\t\t{df491d8d-0598-4495-913e-5b025e54d7f2}\n\tGeneration tool:\t\tDymola Version 2022x (64-bit), 2021-10-08\n\tGeneration time:\t\t2022-03-03T15:09:18Z\n\tVar. naming conv.:\t\tstructured\n\tEvent indicators:\t\t24\n\tInputs:\t\t\t\t0\n\tOutputs:\t\t\t0\n\tStates:\t\t\t\t2\n\t\t33554432 [\"mass.s\"]\n\t\t33554433 [\"mass.v\", \"mass.v_relfric\"]\n\tSupports Co-Simulation:\t\ttrue\n\t\tModel identifier:\tSpringFrictionPendulum1D\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n\t\tVar. com. steps:\ttrue\n\t\tInput interpol.:\ttrue\n\t\tMax order out. der.:\t1\n\tSupports Model-Exchange:\ttrue\n\t\tModel identifier:\tSpringFrictionPendulum1D\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n##################### End information for FMU #####################","category":"page"},{"location":"examples/manipulation/#Simulate-FMU","page":"Manipulate a function","title":"Simulate FMU","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"In the next steps the recorded value is defined. The recorded value is the position of the mass. In the function fmiSimulateME() the FMU is simulated in model-exchange mode (ME) with an adaptive step size. In addition, the start and end time and the recorded variables are specified.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"vrs = [\"mass.s\"]\n\nsimData = fmiSimulateME(myFMU, tStart, tStop; recordValues=vrs)","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"\u001b[34mSimulating ME-FMU ... 100%|██████████████████████████████| Time: 0:00:13\u001b[39m\n\n\n\n\n\nModel name:\n\tSpringFrictionPendulum1D\nSuccess:\n\ttrue\nStates [110]:\n\t0.0\t[0.5, 0.0]\n\t2.3529411764719727e-11\t[0.5, 1.0e-10]\n\t1.0000023529411766e-5\t[0.5000000002125017, 4.250030186348503e-5]\n\t0.00011000002352941177\t[0.5000000257134062, 0.0004675245102952289]\n\t0.0011100000235294118\t[0.5000026191281834, 0.004719970360497647]\n\t0.011110000023529413\t[0.5002631686645611, 0.047449647283752144]\n\t0.03982466736770743\t[0.5034050123596227, 0.17168075110950387]\n\t0.09972054285078226\t[0.5215006197560228, 0.43204954153497455]\n\t0.16481836271111422\t[0.5585747156842935, 0.703758265932321]\n\t...\n\t8.0\t[1.0668213438183276, -1.0000099359121942e-10]\nValues [110]:\n\t0.0\t(0.5,)\n\t2.3529411764719727e-11\t(0.5,)\n\t1.0000023529411766e-5\t(0.5000000002125017,)\n\t0.00011000002352941177\t(0.5000000257134062,)\n\t0.0011100000235294118\t(0.5000026191281834,)\n\t0.011110000023529413\t(0.5002631686645611,)\n\t0.03982466736770743\t(0.5034050123596227,)\n\t0.09972054285078226\t(0.5215006197560228,)\n\t0.16481836271111422\t(0.5585747156842935,)\n\t...\n\t8.0\t(1.0668213438183276,)\nEvents [6]:\n\tState-Event #11 @ 0.0s\n\tState-Event #11 @ 0.9939s\n\tState-Event #19 @ 1.9881s\n\tState-Event #11 @ 2.9829s\n\tState-Event #19 @ 3.9787s\n\tState-Event #11 @ 4.9768s","category":"page"},{"location":"examples/manipulation/#Plotting-FMU","page":"Manipulate a function","title":"Plotting FMU","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"After the simulation is finished, the result of the FMU for the model-exchange mode can be plotted. In the plot for the FMU it can be seen that the oscillation continues to decrease due to the effect of the friction. If you simulate long enough, the oscillation comes to a standstill in a certain time.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"fig = fmiPlot(simData, states=false)","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"(Image: svg)","category":"page"},{"location":"examples/manipulation/#Override-Function","page":"Manipulate a function","title":"Override Function","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"After overwriting a function, the previous one is no longer accessible. The original function fmi2GetReal() is cached by storing the address of the pointer. The addresses of the pointers are kept in the FMU and are thus accessible.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"# save, where the original `fmi2GetReal` function was stored, so we can access it in our new function\noriginalGetReal = myFMU.cGetReal","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"Ptr{Nothing} @0x00007fa504ca1faf","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"To overwrite the function fmi2GetReal!(), the function header of the new custom function must be identical to the previous one. The function header looks like fmi2GetReal!(cfunc::Ptr{Nothing}, c::fmi2Component, vr::Union{Array{fmi2ValueReference}, Ptr{fmi2ValueReference}}, nvr::Csize_t, value::Union{Array{fmi2Real}, Ptr{fmi2Real}})::fmi2Status. The information how the FMI2 function are structured can be seen from FMICore.jl or the FMI2.0.3-specification.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"In the new implementation the original function is called by the previously stored pointer. Next there is a special handling if value is a pointer to an array. In this case the pointer is treated as an array, so that the entries are accessible. Otherwise, each value in value is multiplied by two. Finally, the original state of the original function is output.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"function myGetReal!(c::fmi2Component, vr::Union{Array{fmi2ValueReference}, Ptr{fmi2ValueReference}}, \n                    nvr::Csize_t, value::Union{Array{fmi2Real}, Ptr{fmi2Real}})\n    # first, we do what the original function does\n    status = fmi2GetReal!(originalGetReal, c, vr, nvr, value)\n\n    # if we have a pointer to an array, we must interprete it as array to access elements\n    if isa(value, Ptr{fmi2Real})\n        value = unsafe_wrap(Array{fmi2Real}, value, nvr, own=false)\n    end\n\n    # now, we multiply every value by two (just for fun!)\n    for i in 1:nvr \n        value[i] *= 2.0 \n    end \n\n    # return the original status\n    return status\nend","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"myGetReal! (generic function with 1 method)","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"In the next command the original function is overwritten with the new defined function, for which the command fmiSetFctGetReal() is called.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"# no we overwrite the original function\nfmiSetFctGetReal(myFMU, myGetReal!)","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"Ptr{Nothing} @0x00007fa54dafdfc0","category":"page"},{"location":"examples/manipulation/#Simulate-and-Plot-FMU-with-modified-function","page":"Manipulate a function","title":"Simulate and Plot FMU with modified function","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"As before, the identical command is called here for simulation. This is also a model exchange simulation. Immediately afterwards, the results are added to the previous graph as a dashed line.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"simData = fmiSimulateME(myFMU, tStart, tStop; recordValues=vrs)\nfmiPlot!(fig, simData; states=false, style=:dash)","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"(Image: svg)","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"As expected by overwriting the function, all values are doubled.","category":"page"},{"location":"examples/manipulation/#Unload-FMU","page":"Manipulate a function","title":"Unload FMU","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"After plotting the data, the FMU is unloaded and all unpacked data on disc is removed.","category":"page"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"fmiUnload(myFMU)","category":"page"},{"location":"examples/manipulation/#Summary","page":"Manipulate a function","title":"Summary","text":"","category":"section"},{"location":"examples/manipulation/","page":"Manipulate a function","title":"Manipulate a function","text":"In this tutorial it is shown how an existing function of the library can be replaced by an own implementation. Through this possibility, there are almost no limits for the user, whereby the user can customize the function to his liking.","category":"page"},{"location":"features/#Features","page":"Features","title":"Features","text":"","category":"section"},{"location":"features/","page":"Features","title":"Features","text":"Please note, that this guide focuses also on users, that are not familiar with FMI. The following feature explanations are written in an easy-to-read-fashion, so there might be some points that are scientifically only 95% correct. For further information on FMI and FMUs, see fmi-standard.org.","category":"page"},{"location":"features/#Execution-Configuration","page":"Features","title":"Execution Configuration","text":"","category":"section"},{"location":"features/","page":"Features","title":"Features","text":"Not all FMUs support all features they should according to the FMI-standard, so FMI.jl provides a so called execution configuration.  This configuration is also respected by FMIFlux.jl. The content of the execution configuration may change in future (together with new or deprecated features of linked libraries), but the most important core features will be kept over time. Because not all users need the full potential of this configuration tool, there are three presets given: ","category":"page"},{"location":"features/","page":"Features","title":"Features","text":"myFMU.executionConfig = FMU_EXECUTION_CONFIGURATION_NO_RESET is the default operation mode for FMUs. FMUs are not reset via fmi2Reset, but new instantiated for every simulation run (or training step). This is not the most efficient way, but many FMU have problems with resetting.\nmyFMU.executionConfig = FMU_EXECUTION_CONFIGURATION_RESET is faster for well-implemented FMUs, but needs a fully working fmi2Reset-function. So if you know you have a fully working fmi2Reset, you may be faster with that option.\nmyFMU.executionConfig = FMU_EXECUTION_CONFIGURATION_NO_FREEING should only be the very last choise. If your FMU neither supports fmi2Reset nor a proper fmi2FreeInstance, you could use this configuration as a last way out. Keep in mind, that new FMU instances are allocated but not freed, as long as your Julia instance is running (memory leak). In general, the amount of leaked memory is small, but you need to know what you are doing, if you do thousands or ten-thousands of simulation runs with such a FMU.","category":"page"},{"location":"features/#Model-variable-identification","page":"Features","title":"Model variable identification","text":"","category":"section"},{"location":"features/","page":"Features","title":"Features","text":"FMI.jl offers multiple ways to retrieve your model variables. Any function that accepts a variable identifier can handle the following argument types:","category":"page"},{"location":"features/","page":"Features","title":"Features","text":"UInt32 or fmi2ValueReference for example 1610612742 or 0x16000001: This is the most performant way of passing a variable identifier, but you need to know the value reference (you can determine them by having a look in the modelDescription.xml).\nArray{UInt32} or Array{fmi2ValueReference} for example [1610612742, 1610612743] or [0x16000001, 0x16000002]: This is the most performant way of passing multiple variable identifiers, but you need to know the value references.\nString for example \"ball.s\": This is the most intuitive way, because you might already know the variable name from your modelling environment or model documentation.\nArray{String] for example [\"ball.s\", \"der(ball.s)\"]: This is the most intuitive way, because you might already know the variable names from your modelling environment or model documentation.\nSymbol for example :states: There are multiple symbol wildcards for interesting variable groups like :all, :none, :states, :derivatives, :inputs and :outputs.\nnothing: If you don't want to record anything (same as :none)","category":"page"},{"location":"features/#Event-handling","page":"Features","title":"Event handling","text":"","category":"section"},{"location":"features/","page":"Features","title":"Features","text":"In FMI2, there are basically two types of events: state and time.  State events are triggered, as soon as one or more event indicators - scalar values that describe the \"distance\" in state space to the next state event - crossing zero.  Time events are triggered at known time points during the simulation.  If your model has state and/or time events is detected automatically by FMI.jl and the event handling happens automatically in the background.","category":"page"},{"location":"features/#Model-exchange-(ME)-and-co-simulation-(CS)","page":"Features","title":"Model exchange (ME) and co-simulation (CS)","text":"","category":"section"},{"location":"features/","page":"Features","title":"Features","text":"There are two different model types for FMUs in FMI2: Model exchange (ME) and co-simulation (CS).  If you have a FMU and are only interested in getting it simulated, use fmiSimulate so FMI.jl will automatically pick CS if available and otherwise ME. If you want to force a specific simulation mode, you can use fmiSimulateME (for ME) or fmiSimulateCS (for CS).","category":"page"},{"location":"features/#Simulate-arbitrary-time-intervals","page":"Features","title":"Simulate arbitrary time intervals","text":"","category":"section"},{"location":"features/","page":"Features","title":"Features","text":"You can simply simulate arbitrary time intervals by passing a startTime unequal zero to fmi2SetupExperiment.  Because many FMUs don't support startTime != 0.0 and will throw an error or warning, a time shifting feature inside FMI.jl performs all necessary steps in the background - all corresponding commands like e.g. fmi2SetTime or fmi2NewDiscreteStates act like the desired time interval is simulated. If you don't want this feature (maybe because you are simulating time-dependent systems), you may use the execution configuration myFMU.executionConfig.autoTimeShift=false while providing a startTime != 0.0.","category":"page"},{"location":"features/#Performance","page":"Features","title":"Performance","text":"","category":"section"},{"location":"features/","page":"Features","title":"Features","text":"Many commands in FMI.jl are available in in-place and out-of-place semantics. Of course, in-place-calls are faster, because they don't need to allocate new memory at every call (for the return values). So if you have an eye on performance (or must have), a good starting point is to substitute out-of-place- with in-place-calls. Typical improvements are:","category":"page"},{"location":"features/","page":"Features","title":"Features","text":"valueArray = fmi2GetReal(args...) -> fmi2GetReal!(args..., valueArray)\nvalueArray = fmi2GetDerivatives(args...) -> fmi2GetDerivatives!(args..., valueArray)\nvalueArray = fmi2NewDiscreteStates(args...) -> fmi2NewDiscreteStates!(args..., valueArray)","category":"page"},{"location":"features/","page":"Features","title":"Features","text":"Of course, you have to use the same piece of memory (to write your return values in) for multiple calls - otherwise there will be no improvement because the number of allocations stays the same.","category":"page"},{"location":"features/#Watch-your-progress","page":"Features","title":"Watch your progress","text":"","category":"section"},{"location":"features/","page":"Features","title":"Features","text":"When simulating FMUs with FMI.jl, a progress meter is shown per default. You can control the appearance via the keyword argument showProgress for fmiSimulate, fmiSimulateME and fmiSimulateCS.  Progress meters are also available for FMIFlux.jl, but deactivated by default (during training, this can be a bit too much). When evaluating a NeuralFMU, you can use the same keyword with showProgress=true to show a progress bar during training, too. The simulation trajectory (also called the solution of your FMU's ODE system) can be plotted using fmiPlot(myFMU, solution), all axis will be labeled automatically.","category":"page"},{"location":"related/#Related-Publications","page":"Related Publication","title":"Related Publications","text":"","category":"section"},{"location":"related/","page":"Related Publication","title":"Related Publication","text":"Tobias Thummerer, Josef Kircher, Lars Mikelsons 2021 NeuralFMU: Towards Structural Integration of FMUs into Neural Networks (14th Modelica Conference, Preprint, Accepted) arXiv:2109.04351","category":"page"},{"location":"related/","page":"Related Publication","title":"Related Publication","text":"Tobias Thummerer, Johannes Tintenherr, Lars Mikelsons 2021 Hybrid modeling of the human cardiovascular system using NeuralFMUs (10th International Conference on Mathematical Modeling in Physical Sciences, Preprint, Accepted) arXiv:2109.04880","category":"page"},{"location":"examples/multiple_instances/#Multiple-Instances-of-an-FMU","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"Tutorial by Johannes Stoljar, Tobias Thummerer","category":"page"},{"location":"examples/multiple_instances/#License","page":"Multiple Instances of an FMU","title":"License","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"Copyright (c) 2021 Tobias Thummerer, Lars Mikelsons, Josef Kircher, Johannes Stoljar","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"Licensed under the MIT license. See LICENSE file in the project root for details.","category":"page"},{"location":"examples/multiple_instances/#Motivation","page":"Multiple Instances of an FMU","title":"Motivation","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"This Julia Package FMI.jl is motivated by the use of simulation models in Julia. Here the FMI specification is implemented. FMI (Functional Mock-up Interface) is a free standard (fmi-standard.org) that defines a container and an interface to exchange dynamic models using a combination of XML files, binaries and C code zipped into a single file. The user can thus use simulation models in the form of an FMU (Functional Mock-up Units). Besides loading the FMU, the user can also set values for parameters and states and simulate the FMU both as co-simulation and model exchange simulation.","category":"page"},{"location":"examples/multiple_instances/#Introduction-to-the-example","page":"Multiple Instances of an FMU","title":"Introduction to the example","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"In this example we want to show that it is possible to create different instances of an FMU. The different instances can then be used to run independent simulations. After the FMU has been simulated, the simulation results are displayed in a graph. The used model is a one-dimensional spring pendulum without friction. The object-orientated structure of the SpringPendulum1D can be seen in the following graphic.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"(Image: svg)  ","category":"page"},{"location":"examples/multiple_instances/#Target-group","page":"Multiple Instances of an FMU","title":"Target group","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"The example is primarily intended for users who work in the field of simulations. The example wants to show how simple it is to use FMUs in Julia.","category":"page"},{"location":"examples/multiple_instances/#Other-formats","page":"Multiple Instances of an FMU","title":"Other formats","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"Besides, this Jupyter Notebook there is also a Julia file with the same name, which contains only the code cells and for the documentation there is a Markdown file corresponding to the notebook.  ","category":"page"},{"location":"examples/multiple_instances/#Getting-started","page":"Multiple Instances of an FMU","title":"Getting started","text":"","category":"section"},{"location":"examples/multiple_instances/#Installation-prerequisites","page":"Multiple Instances of an FMU","title":"Installation prerequisites","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":" Description Command Alternative\n1. Enter Package Manager via ] \n2. Install FMI via add FMI add \" https://github.com/ThummeTo/FMI.jl \"\n3. Install FMIZoo via add FMIZoo add \" https://github.com/ThummeTo/FMIZoo.jl \"\n4. Install Plots via add Plots ","category":"page"},{"location":"examples/multiple_instances/#Code-section","page":"Multiple Instances of an FMU","title":"Code section","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"To run the example, the previously installed packages must be included. ","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"# imports\nusing FMI\nusing FMIZoo\nusing Plots","category":"page"},{"location":"examples/multiple_instances/#Simulation-setup","page":"Multiple Instances of an FMU","title":"Simulation setup","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"Next, the start time and end time of the simulation are set. Finally, the recorded values are specified to store the results of the simulation.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"tStart = 0.0\ntStop = 8.0\n\nvrs = [\"mass.s\"]","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"1-element Vector{String}:\n \"mass.s\"","category":"page"},{"location":"examples/multiple_instances/#Import-FMU","page":"Multiple Instances of an FMU","title":"Import FMU","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"In the next lines of code the FMU model from FMIZoo.jl is loaded and the information about the FMU is shown.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"# we use an FMU from the FMIZoo.jl\npathToFMU = get_model_filename(\"SpringPendulum1D\", \"Dymola\", \"2022x\")\n\nmyFMU = fmiLoad(pathToFMU)\nfmiInfo(myFMU)","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"┌ Info: fmi2Unzip(...): Successfully unzipped 29 files at `/tmp/fmijl_KBJT4J/SpringPendulum1D`.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/OUODz/src/FMI2_ext.jl:75\n┌ Info: fmi2Load(...): FMU resources location is `file:////tmp/fmijl_KBJT4J/SpringPendulum1D/resources`\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/OUODz/src/FMI2_ext.jl:190\n┌ Info: fmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/OUODz/src/FMI2_ext.jl:193\n\n\n#################### Begin information for FMU ####################\n\tModel name:\t\t\tSpringPendulum1D\n\tFMI-Version:\t\t\t2.0\n\tGUID:\t\t\t\t{a3e886fa-675c-4308-8e91-3490e598ba11}\n\tGeneration tool:\t\tDymola Version 2022x (64-bit), 2021-10-08\n\tGeneration time:\t\t2022-03-03T15:08:57Z\n\tVar. naming conv.:\t\tstructured\n\tEvent indicators:\t\t0\n\tInputs:\t\t\t\t0\n\tOutputs:\t\t\t0\n\tStates:\t\t\t\t2\n\t\t33554432 [\"mass.s\"]\n\t\t33554433 [\"mass.v\"]\n\tSupports Co-Simulation:\t\ttrue\n\t\tModel identifier:\tSpringPendulum1D\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n\t\tVar. com. steps:\ttrue\n\t\tInput interpol.:\ttrue\n\t\tMax order out. der.:\t1\n\tSupports Model-Exchange:\ttrue\n\t\tModel identifier:\tSpringPendulum1D\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n##################### End information for FMU #####################","category":"page"},{"location":"examples/multiple_instances/#First-Instance","page":"Multiple Instances of an FMU","title":"First Instance","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"To create an instance of the FMU it is necessary to call the command fmiInstantiate!(). With the component address you now have a unique instance of the FMU.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"comp1 = fmiInstantiate!(myFMU; loggingOn=true)\ncomp1Address= comp1.compAddr\nprintln(comp1)","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"FMU:            SpringPendulum1D\nInstanceName:   [not defined]\nAddress:        Ptr{Nothing} @0x000000000348d080\nState:          fmi2ComponentStateInstantiated\nLogging:        false\nFMU time:       -Inf\nFMU states:     nothing","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"Next, a dictionary for the parameters is created. With this dictionary you can set the initial states of the variables of the FMU. For the spring constant spring.c a value of 100 fracNm and for the position of the mass mass.s a value of 10 m is set. The created dictionary with the specified variables for recording are passed to the command for simulation.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"param1 = Dict(\"spring.c\"=>10.0, \"mass_s0\"=>1.0)\ndata1 = fmiSimulate(comp1, tStart, tStop; parameters=param1, recordValues=vrs, instantiate=false)\nfig = fmiPlot(data1)","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"(Image: svg)","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"For control, you can compare again the address of the instance to the previous address, and it should be the same address. As soon as this is not the case an error would be thrown by the macro @assert.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"@assert comp1.compAddr === comp1Address","category":"page"},{"location":"examples/multiple_instances/#Second-Instance","page":"Multiple Instances of an FMU","title":"Second Instance","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"To create a second instance of the FMU it is necessary to call the command fmiInstantiate!(). With the component address you now have a unique instance of the FMU.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"comp2 = fmiInstantiate!(myFMU; loggingOn=true)\ncomp2Address= comp2.compAddr\nprintln(comp2)","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"FMU:            SpringPendulum1D\nInstanceName:   [not defined]\nAddress:        Ptr{Nothing} @0x0000000006214590\nState:          fmi2ComponentStateInstantiated\nLogging:        true\nFMU time:       -Inf\nFMU states:     nothing","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"The addresses of the instantiated FMUs must differ, and you can see that in the comparison below.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"@assert comp1Address !== comp2Address","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"Again, a dictionary for the parameters is created. With this dictionary you can set the initial states of the variables of the FMU. For the spring constant spring.c a value of 10 fracNm and for the position of the mass mass.s a value of 20 m is set. The created dictionary with the specified variables for recording are passed to the command for simulation.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"param2 = Dict(\"spring.c\"=>1.0, \"mass.s\"=>2.0)\ndata2 = fmiSimulateCS(comp2, tStart, tStop;  parameters=param2, recordValues=vrs, instantiate=false)\nfmiPlot!(fig, data2)","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"(Image: svg)","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"For control, you can compare again the address of the instance comp2 to the previous address comp2Address and it should be the same address.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"@assert comp2.compAddr === comp2Address","category":"page"},{"location":"examples/multiple_instances/#Unload-FMU","page":"Multiple Instances of an FMU","title":"Unload FMU","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"After plotting the data, the FMU is unloaded and all unpacked data on disc is removed.","category":"page"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"fmiUnload(myFMU)","category":"page"},{"location":"examples/multiple_instances/#Summary","page":"Multiple Instances of an FMU","title":"Summary","text":"","category":"section"},{"location":"examples/multiple_instances/","page":"Multiple Instances of an FMU","title":"Multiple Instances of an FMU","text":"Based on the example it can be seen that it is possible to create different instances of an FMU. The different instances can then be used to perform different simulations.","category":"page"},{"location":"examples/overview/#Overview","page":"Overview","title":"Overview","text":"","category":"section"},{"location":"examples/overview/","page":"Overview","title":"Overview","text":"This section discusses the included examples of the FMI.jl library. So you can execute them on your machine and get detailed information about all the steps. If you require further information about the function calls, see library or fmu2 function sections.","category":"page"},{"location":"examples/overview/","page":"Overview","title":"Overview","text":"The examples are:","category":"page"},{"location":"examples/overview/","page":"Overview","title":"Overview","text":"Simulate: Showing how you can simulate a CS-FMU and a ME-FMU.\nParameterize: A short example explaining how to parameterize a FMU before simulation.\nMultiple instances: Showing the use of multiple instances.\nModelica conference 2021: Showing the different variants of simulating an FMU.\nManipulation: Showing how to redefine a library function.\nMultithreading: Shows how to use multithreading to simulate multiple FMUs.\nMultiprocessing: Shows how to use multiprocessing to simulate multiple FMUs.","category":"page"},{"location":"examples/multithreading/#Manipulate-a-function","page":"Manipulate a function","title":"Manipulate a function","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"Tutorial by Jonas Wilfert, Tobias Thummerer","category":"page"},{"location":"examples/multithreading/#License","page":"Manipulate a function","title":"License","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"Copyright (c) 2021 Tobias Thummerer, Lars Mikelsons, Josef Kircher, Johannes Stoljar, Jonas Wilfert","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"Licensed under the MIT license. See LICENSE file in the project root for details.","category":"page"},{"location":"examples/multithreading/#Motivation","page":"Manipulate a function","title":"Motivation","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"This Julia Package FMI.jl is motivated by the use of simulation models in Julia. Here the FMI specification is implemented. FMI (Functional Mock-up Interface) is a free standard (fmi-standard.org) that defines a container and an interface to exchange dynamic models using a combination of XML files, binaries and C code zipped into a single file. The user can thus use simulation models in the form of an FMU (Functional Mock-up Units). Besides loading the FMU, the user can also set values for parameters and states and simulate the FMU both as co-simulation and model exchange simulation.","category":"page"},{"location":"examples/multithreading/#Introduction-to-the-example","page":"Manipulate a function","title":"Introduction to the example","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"This example shows how to parallelize the computation of an FMU in FMI.jl. We can compute a batch of FMU-evaluations in parallel with different initial settings. Parallelization can be achieved using multithreading or using multiprocessing. This example shows multithreading, check multiprocessing.ipynb for multiprocessing. Advantage of multithreading is a lower communication overhead as well as lower RAM usage. However in some cases multiprocessing can be faster as the garbage collector is not shared.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"The model used is a one-dimensional spring pendulum with friction. The object-orientated structure of the SpringFrictionPendulum1D can be seen in the following graphic.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"(Image: svg)  ","category":"page"},{"location":"examples/multithreading/#Target-group","page":"Manipulate a function","title":"Target group","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"The example is primarily intended for users who work in the field of simulations. The example wants to show how simple it is to use FMUs in Julia.","category":"page"},{"location":"examples/multithreading/#Other-formats","page":"Manipulate a function","title":"Other formats","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"Besides, this Jupyter Notebook there is also a Julia file with the same name, which contains only the code cells and for the documentation there is a Markdown file corresponding to the notebook.  ","category":"page"},{"location":"examples/multithreading/#Getting-started","page":"Manipulate a function","title":"Getting started","text":"","category":"section"},{"location":"examples/multithreading/#Installation-prerequisites","page":"Manipulate a function","title":"Installation prerequisites","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":" Description Command Alternative\n1. Enter Package Manager via ] \n2. Install FMI via add FMI add \" https://github.com/ThummeTo/FMI.jl \"\n3. Install FMIZoo via add FMIZoo add \" https://github.com/ThummeTo/FMIZoo.jl \"\n4. Install FMICore via add FMICore add \" https://github.com/ThummeTo/FMICore.jl \"\n5. Install Folds via add Folds \n6. Install BenchmarkTools via add BenchmarkTools ","category":"page"},{"location":"examples/multithreading/#Code-section","page":"Manipulate a function","title":"Code section","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"To run the example, the previously installed packages must be included. ","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"# imports\nusing FMI\nusing FMIZoo\nusing Folds\nusing BenchmarkTools","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"First, check the amount of available threads:","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"Threads.nthreads()","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"1","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"If the number of available threads doesn't match your expections, you can increase the number of threads available to the Julia process like described here.","category":"page"},{"location":"examples/multithreading/#Simulation-setup","page":"Manipulate a function","title":"Simulation setup","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"Next, the start time and end time of the simulation are set. Here we also decide the size of the batch.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"t_start = 0.0\nt_step = 0.1\nt_stop = 10.0\ntspan = (t_start, t_stop)\ntData = collect(t_start:t_step:t_stop)\n\n# Best if batchSize is a multiple of the threads/cores\nbatchSize = Threads.nthreads()\n\n# Define an array of arrays randomly\ninput_values = collect(collect.(eachrow(rand(batchSize,2))))\n","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"1-element Vector{Vector{Float64}}:\n [0.7960782342277479, 0.8341406038295938]","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"We need to instantiate one FMU for each parallel execution, as they cannot be easily shared among different threads.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"# a single FMU to compare the performance\nrealFMU = fmiLoad(\"SpringPendulum1D\", \"Dymola\", \"2022x\")\n\n# the FMU batch\nrealFMUBatch = [fmiLoad(\"SpringPendulum1D\", \"Dymola\", \"2022x\") for _ in 1:batchSize]","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"┌ Info: fmi2Unzip(...): Successfully unzipped 153 files at `/tmp/fmijl_oCF2y0/SpringPendulum1D`.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/gTZB4/src/FMI2_ext.jl:76\n┌ Info: fmi2Load(...): FMU resources location is `file:////tmp/fmijl_oCF2y0/SpringPendulum1D/resources`\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/gTZB4/src/FMI2_ext.jl:192\n┌ Info: fmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/gTZB4/src/FMI2_ext.jl:195\n┌ Info: fmi2Unzip(...): Successfully unzipped 153 files at `/tmp/fmijl_hDkJe0/SpringPendulum1D`.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/gTZB4/src/FMI2_ext.jl:76\n┌ Info: fmi2Load(...): FMU resources location is `file:////tmp/fmijl_hDkJe0/SpringPendulum1D/resources`\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/gTZB4/src/FMI2_ext.jl:192\n┌ Info: fmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/gTZB4/src/FMI2_ext.jl:195\n\n\n\n\n\n1-element Vector{FMU2}:\n Model name:        SpringPendulum1D\nType:              1","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"We define a helper function to calculate the FMU solution and combine it into an Matrix.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"function runCalcFormatted(fmu::FMU2, x0::Vector{Float64}, recordValues::Vector{String}=[\"mass.s\", \"mass.v\"])\n    data = fmiSimulateME(fmu, t_start, t_stop; recordValues=recordValues, saveat=tData, x0=x0, showProgress=false, dtmax=1e-4)\n    return reduce(hcat, data.states.u)\nend","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"runCalcFormatted (generic function with 2 methods)","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"Running a single evaluation is pretty quick, therefore the speed can be better tested with BenchmarkTools.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"@benchmark data = runCalcFormatted(realFMU, rand(2))","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"BenchmarkTools.Trial: 16 samples with 1 evaluation.\n Range \u001b[90m(\u001b[39m\u001b[36m\u001b[1mmin\u001b[22m\u001b[39m … \u001b[35mmax\u001b[39m\u001b[90m):  \u001b[39m\u001b[36m\u001b[1m328.343 ms\u001b[22m\u001b[39m … \u001b[35m348.673 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmin … max\u001b[90m): \u001b[39m4.38% … 4.01%\n Time  \u001b[90m(\u001b[39m\u001b[34m\u001b[1mmedian\u001b[22m\u001b[39m\u001b[90m):     \u001b[39m\u001b[34m\u001b[1m330.302 ms               \u001b[22m\u001b[39m\u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmedian\u001b[90m):    \u001b[39m4.35%\n Time  \u001b[90m(\u001b[39m\u001b[32m\u001b[1mmean\u001b[22m\u001b[39m ± \u001b[32mσ\u001b[39m\u001b[90m):   \u001b[39m\u001b[32m\u001b[1m332.015 ms\u001b[22m\u001b[39m ± \u001b[32m  5.093 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmean ± σ\u001b[90m):  \u001b[39m4.56% ± 0.69%\n\n  \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m█\u001b[34m \u001b[39m\u001b[39m▄\u001b[39m \u001b[39m \u001b[39m \u001b[32m \u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \n  \u001b[39m▆\u001b[39m▆\u001b[39m▆\u001b[39m▆\u001b[39m▆\u001b[39m█\u001b[34m▁\u001b[39m\u001b[39m█\u001b[39m▆\u001b[39m▁\u001b[39m▁\u001b[32m▁\u001b[39m\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▆\u001b[39m▁\u001b[39m▁\u001b[39m▆\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▆\u001b[39m \u001b[39m▁\n  328 ms\u001b[90m           Histogram: frequency by time\u001b[39m          349 ms \u001b[0m\u001b[1m<\u001b[22m\n\n Memory estimate\u001b[90m: \u001b[39m\u001b[33m146.80 MiB\u001b[39m, allocs estimate\u001b[90m: \u001b[39m\u001b[33m3002431\u001b[39m.","category":"page"},{"location":"examples/multithreading/#Single-Threaded-Batch-Execution","page":"Manipulate a function","title":"Single Threaded Batch Execution","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"To compute a batch we can collect multiple evaluations. In a single threaded context we can use the same FMU for every call.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"println(\"Single Threaded\")\n@benchmark collect(runCalcFormatted(realFMU, i) for i in input_values)","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"Single Threaded\n\n\n\n\n\nBenchmarkTools.Trial: 15 samples with 1 evaluation.\n Range \u001b[90m(\u001b[39m\u001b[36m\u001b[1mmin\u001b[22m\u001b[39m … \u001b[35mmax\u001b[39m\u001b[90m):  \u001b[39m\u001b[36m\u001b[1m330.797 ms\u001b[22m\u001b[39m … \u001b[35m350.745 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmin … max\u001b[90m): \u001b[39m4.71% … 4.35%\n Time  \u001b[90m(\u001b[39m\u001b[34m\u001b[1mmedian\u001b[22m\u001b[39m\u001b[90m):     \u001b[39m\u001b[34m\u001b[1m334.082 ms               \u001b[22m\u001b[39m\u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmedian\u001b[90m):    \u001b[39m4.63%\n Time  \u001b[90m(\u001b[39m\u001b[32m\u001b[1mmean\u001b[22m\u001b[39m ± \u001b[32mσ\u001b[39m\u001b[90m):   \u001b[39m\u001b[32m\u001b[1m335.362 ms\u001b[22m\u001b[39m ± \u001b[32m  4.790 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmean ± σ\u001b[90m):  \u001b[39m4.75% ± 0.56%\n\n  \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m█\u001b[39m \u001b[34m \u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[32m \u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \n  \u001b[39m▇\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m█\u001b[39m▇\u001b[34m▁\u001b[39m\u001b[39m▇\u001b[39m▇\u001b[39m▇\u001b[39m▁\u001b[32m▇\u001b[39m\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m \u001b[39m▁\n  331 ms\u001b[90m           Histogram: frequency by time\u001b[39m          351 ms \u001b[0m\u001b[1m<\u001b[22m\n\n Memory estimate\u001b[90m: \u001b[39m\u001b[33m146.80 MiB\u001b[39m, allocs estimate\u001b[90m: \u001b[39m\u001b[33m3002434\u001b[39m.","category":"page"},{"location":"examples/multithreading/#Multithreaded-Batch-Execution","page":"Manipulate a function","title":"Multithreaded Batch Execution","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"In a multithreaded context we have to provide each thread it's own fmu, as they are not thread safe. To spread the execution of a function to multiple threads, the library Folds can be used.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"println(\"Multi Threaded\")\n@benchmark Folds.collect(runCalcFormatted(fmu, i) for (fmu, i) in zip(realFMUBatch, input_values))","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"Multi Threaded\n\n\n\n\n\nBenchmarkTools.Trial: 16 samples with 1 evaluation.\n Range \u001b[90m(\u001b[39m\u001b[36m\u001b[1mmin\u001b[22m\u001b[39m … \u001b[35mmax\u001b[39m\u001b[90m):  \u001b[39m\u001b[36m\u001b[1m310.491 ms\u001b[22m\u001b[39m … \u001b[35m331.078 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmin … max\u001b[90m): \u001b[39m5.09% … 4.76%\n Time  \u001b[90m(\u001b[39m\u001b[34m\u001b[1mmedian\u001b[22m\u001b[39m\u001b[90m):     \u001b[39m\u001b[34m\u001b[1m311.690 ms               \u001b[22m\u001b[39m\u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmedian\u001b[90m):    \u001b[39m5.07%\n Time  \u001b[90m(\u001b[39m\u001b[32m\u001b[1mmean\u001b[22m\u001b[39m ± \u001b[32mσ\u001b[39m\u001b[90m):   \u001b[39m\u001b[32m\u001b[1m313.395 ms\u001b[22m\u001b[39m ± \u001b[32m  5.146 ms\u001b[39m  \u001b[90m┊\u001b[39m GC \u001b[90m(\u001b[39mmean ± σ\u001b[90m):  \u001b[39m5.19% ± 0.58%\n\n  \u001b[39m█\u001b[39m \u001b[39m█\u001b[34m▃\u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[32m \u001b[39m\u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \u001b[39m \n  \u001b[39m█\u001b[39m▇\u001b[39m█\u001b[34m█\u001b[39m\u001b[39m▇\u001b[39m▇\u001b[39m▇\u001b[39m▇\u001b[39m▁\u001b[32m▇\u001b[39m\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▁\u001b[39m▇\u001b[39m \u001b[39m▁\n  310 ms\u001b[90m           Histogram: frequency by time\u001b[39m          331 ms \u001b[0m\u001b[1m<\u001b[22m\n\n Memory estimate\u001b[90m: \u001b[39m\u001b[33m146.80 MiB\u001b[39m, allocs estimate\u001b[90m: \u001b[39m\u001b[33m3002438\u001b[39m.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"As you can see, there is a significant speed-up in the median execution time. But: The speed-up is often much smaller than Threads.nthreads(), this has different reasons. For a rule of thumb, the speed-up should be around n/2 on a n-core-processor with n threads for the Julia process.","category":"page"},{"location":"examples/multithreading/#Unload-FMU","page":"Manipulate a function","title":"Unload FMU","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"After calculating the data, the FMU is unloaded and all unpacked data on disc is removed.","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"fmiUnload(realFMU)\nfmiUnload.(realFMUBatch)","category":"page"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"1-element Vector{Nothing}:\n nothing","category":"page"},{"location":"examples/multithreading/#Summary","page":"Manipulate a function","title":"Summary","text":"","category":"section"},{"location":"examples/multithreading/","page":"Manipulate a function","title":"Manipulate a function","text":"In this tutorial it is shown how multi threading with Folds.jl can be used to improve the performance for calculating a Batch of FMUs.","category":"page"},{"location":"examples/simulate/#Simulate-an-FMU-in-different-modes","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"Tutorial by Johannes Stoljar, Tobias Thummerer","category":"page"},{"location":"examples/simulate/#License","page":"Simulate an FMU in different modes","title":"License","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"Copyright (c) 2021 Tobias Thummerer, Lars Mikelsons, Josef Kircher, Johannes Stoljar","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"Licensed under the MIT license. See LICENSE file in the project root for details.","category":"page"},{"location":"examples/simulate/#Motivation","page":"Simulate an FMU in different modes","title":"Motivation","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"This Julia Package FMI.jl is motivated by the use of simulation models in Julia. Here the FMI specification is implemented. FMI (Functional Mock-up Interface) is a free standard (fmi-standard.org) that defines a container and an interface to exchange dynamic models using a combination of XML files, binaries and C code zipped into a single file. The user can thus use simulation models in the form of an FMU (Functional Mock-up Units). Besides loading the FMU, the user can also set values for parameters and states and simulate the FMU both as co-simulation and model exchange simulation.","category":"page"},{"location":"examples/simulate/#Introduction-to-the-example","page":"Simulate an FMU in different modes","title":"Introduction to the example","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"In this example we want to show how fast and easy the simulation for an FMU is. For this purpose, the FMU is simulated in co-simulation mode and in model-exchange mode. After the FMU has been simulated, the simulation results are displayed in a graph. The graphs of the different modes are compared with each other. The used model is a one-dimensional spring pendulum with friction. The object-orientated structure of the SpringFrictionPendulum1D can be seen in the following graphic.","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"(Image: svg)  ","category":"page"},{"location":"examples/simulate/#Target-group","page":"Simulate an FMU in different modes","title":"Target group","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"The example is primarily intended for users who work in the field of simulations. The example wants to show how simple it is to use FMUs in Julia.","category":"page"},{"location":"examples/simulate/#Other-formats","page":"Simulate an FMU in different modes","title":"Other formats","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"Besides, this Jupyter Notebook there is also a Julia file with the same name, which contains only the code cells and for the documentation there is a Markdown file corresponding to the notebook.  ","category":"page"},{"location":"examples/simulate/#Getting-started","page":"Simulate an FMU in different modes","title":"Getting started","text":"","category":"section"},{"location":"examples/simulate/#Installation-prerequisites","page":"Simulate an FMU in different modes","title":"Installation prerequisites","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":" Description Command Alternative\n1. Enter Package Manager via ] \n2. Install FMI via add FMI add \" https://github.com/ThummeTo/FMI.jl \"\n3. Install FMIZoo via add FMIZoo add \" https://github.com/ThummeTo/FMIZoo.jl \"\n4. Install Plots via add Plots ","category":"page"},{"location":"examples/simulate/#Code-section","page":"Simulate an FMU in different modes","title":"Code section","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"To run the example, the previously installed packages must be included. ","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"# imports\nusing FMI\nusing FMIZoo\nusing Plots","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"┌ Warning: Replacing docs for `FMI.fmiPlot :: Tuple{FMICore.FMU2Solution}` in module `FMI`\n└ @ Base.Docs docs/Docs.jl:240","category":"page"},{"location":"examples/simulate/#Simulation-setup","page":"Simulate an FMU in different modes","title":"Simulation setup","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"Next, the start time and end time of the simulation are set. Finally, a step size is specified to store the results of the simulation at these time steps.","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"tStart = 0.0\ntStep = 0.01\ntStop = 8.0\ntSave = tStart:tStep:tStop","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"0.0:0.01:8.0","category":"page"},{"location":"examples/simulate/#Import-FMU","page":"Simulate an FMU in different modes","title":"Import FMU","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"In the next lines of code the FMU model from FMIZoo.jl is loaded and the information about the FMU is shown.","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"# we use an FMU from the FMIZoo.jl\npathToFMU = get_model_filename(\"SpringFrictionPendulum1D\", \"Dymola\", \"2022x\")\n\nmyFMU = fmiLoad(pathToFMU)\n# fmiLoad(\"path/to/myFMU.fmu\"; unpackPath = \"path/to/unpacked/fmu/\")\n\nfmiInfo(myFMU)","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"┌ Info: fmi2Unzip(...): Successfully unzipped 29 files at `/tmp/fmijl_TJndII/SpringFrictionPendulum1D`.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:75\n┌ Info: fmi2Load(...): FMU resources location is `file:////tmp/fmijl_TJndII/SpringFrictionPendulum1D/resources`\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:190\n┌ Info: fmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:193\n\n\n#################### Begin information for FMU ####################\n\tModel name:\t\t\tSpringFrictionPendulum1D\n\tFMI-Version:\t\t\t2.0\n\tGUID:\t\t\t\t{df491d8d-0598-4495-913e-5b025e54d7f2}\n\tGeneration tool:\t\tDymola Version 2022x (64-bit), 2021-10-08\n\tGeneration time:\t\t2022-03-03T15:09:18Z\n\tVar. naming conv.:\t\tstructured\n\tEvent indicators:\t\t24\n\tInputs:\t\t\t\t0\n\tOutputs:\t\t\t0\n\tStates:\t\t\t\t2\n\t\t33554432 [\"mass.s\"]\n\t\t33554433 [\"mass.v\", \"mass.v_relfric\"]\n\tSupports Co-Simulation:\t\ttrue\n\t\tModel identifier:\tSpringFrictionPendulum1D\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n\t\tVar. com. steps:\ttrue\n\t\tInput interpol.:\ttrue\n\t\tMax order out. der.:\t1\n\tSupports Model-Exchange:\ttrue\n\t\tModel identifier:\tSpringFrictionPendulum1D\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n##################### End information for FMU #####################","category":"page"},{"location":"examples/simulate/#Simulate-FMU","page":"Simulate an FMU in different modes","title":"Simulate FMU","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"In the following, the FMU is simulated in the two different simulation modes.","category":"page"},{"location":"examples/simulate/#Simulate-as-Co-Simulation","page":"Simulate an FMU in different modes","title":"Simulate as Co-Simulation","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"In the next steps the recorded values are defined. The first state is the position of the mass and the second state is the velocity. In the function fmiSimulateCS() the FMU is simulated in co-simulation mode (CS) with an adaptive step size but with fixed save points tSave. In addition, the start and end time and the recorded variables are specified.","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"vrs = [\"mass.s\", \"mass.v\"]\n\ndataCS = fmiSimulateCS(myFMU, tStart, tStop; recordValues=vrs, saveat=tSave)","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"Model name:\n\tSpringFrictionPendulum1D\nSuccess:\n\ttrue\nValues [801]:\n\t0.0\t(0.5, 0.0)\n\t0.01\t(0.5002235448486548, 0.042692491939260585)\n\t0.02\t(0.5008715291319449, 0.08568000508550636)\n\t0.03\t(0.5019478597521578, 0.12892136998736314)\n\t0.04\t(0.5034570452098334, 0.17232325681284336)\n\t0.05\t(0.5053993458877354, 0.2158440857658765)\n\t0.06\t(0.5077764240578201, 0.259420181133082)\n\t0.07\t(0.5105886522837868, 0.30295578207463486)\n\t0.08\t(0.5138351439717114, 0.3464184707972189)\n\t...\n\t8.0\t(1.071367253976742, -1.000814138594347e-10)\nEvents [0]:","category":"page"},{"location":"examples/simulate/#Simulate-as-Model-Exchange","page":"Simulate an FMU in different modes","title":"Simulate as Model-Exchange","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"In the function fmiSimulateME() the FMU is simulated in model-exchange mode (ME) with an adaptive step size but with fixed save points tSave. In addition, the start and end time are specified. In contrast to the co-simulation, the values to be stored are not specified here, since the states and events of the FMU are always output as well. The identifiers given above just correspond to the states of the FMU.","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"dataME = fmiSimulateME(myFMU, tStart, tStop; saveat=tSave)","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"\u001b[34mSimulating ME-FMU ... 100%|██████████████████████████████| Time: 0:00:11\u001b[39m\n\n\n\n\n\nModel name:\n\tSpringFrictionPendulum1D\nSuccess:\n\ttrue\nStates [801]:\n\t0.0\t[0.5, 0.0]\n\t0.01\t[0.5002131418344649, 0.042689450666241]\n\t0.02\t[0.5008548874805565, 0.08570846215523381]\n\t0.03\t[0.5019281653120716, 0.12898389312495082]\n\t0.04\t[0.5034351805057593, 0.17244393475170294]\n\t0.05\t[0.5053774287967188, 0.2160182432854046]\n\t0.06\t[0.5077556967622916, 0.25963796675862466]\n\t0.07\t[0.5105701003205937, 0.3032358690888718]\n\t0.08\t[0.5138201049458624, 0.34674641820324037]\n\t...\n\t8.0\t[1.0668213438183276, -1.0000099359121942e-10]\nEvents [6]:\n\tState-Event #11 @ 0.0s\n\tState-Event #11 @ 0.9939s\n\tState-Event #19 @ 1.9881s\n\tState-Event #11 @ 2.9829s\n\tState-Event #19 @ 3.9787s\n\tState-Event #11 @ 4.9768s","category":"page"},{"location":"examples/simulate/#Plotting-FMU","page":"Simulate an FMU in different modes","title":"Plotting FMU","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"After the simulation is finished the results of the FMU for the co-simulation and model-exchange mode can be plotted. In the plot for the FMU it can be seen that the oscillation continues to decrease due to the effect of the friction. If you simulate long enough, the oscillation comes to a standstill in a certain time.","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"fmiPlot(dataCS)","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"(Image: svg)","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"fmiPlot(dataME)","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"(Image: svg)","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"From both graphs it can be seen that the simulation calculates exactly the same results.","category":"page"},{"location":"examples/simulate/#Unload-FMU","page":"Simulate an FMU in different modes","title":"Unload FMU","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"After plotting the data, the FMU is unloaded and all unpacked data on disc is removed.","category":"page"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"fmiUnload(myFMU)","category":"page"},{"location":"examples/simulate/#Summary","page":"Simulate an FMU in different modes","title":"Summary","text":"","category":"section"},{"location":"examples/simulate/","page":"Simulate an FMU in different modes","title":"Simulate an FMU in different modes","text":"Based on this tutorial it can be seen that simulating in the different mode is very easy, and it only takes a few commands to simulate the FMU. ","category":"page"},{"location":"examples/modelica_conference_2021/#Advanced-Simulation-of-an-FMU","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"Tutorial by Johannes Stoljar, Tobias Thummerer","category":"page"},{"location":"examples/modelica_conference_2021/#License","page":"Advanced Simulation of an FMU","title":"License","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"Copyright (c) 2021 Tobias Thummerer, Lars Mikelsons, Josef Kircher, Johannes Stoljar","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"Licensed under the MIT license. See LICENSE file in the project root for details.","category":"page"},{"location":"examples/modelica_conference_2021/#Motivation","page":"Advanced Simulation of an FMU","title":"Motivation","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"This Julia Package FMI.jl is motivated by the use of simulation models in Julia. Here the FMI specification is implemented. FMI (Functional Mock-up Interface) is a free standard (fmi-standard.org) that defines a container and an interface to exchange dynamic models using a combination of XML files, binaries and C code zipped into a single file. The user can thus use simulation models in the form of an FMU (Functional Mock-up Units). Besides loading the FMU, the user can also set values for parameters and states and simulate the FMU both as co-simulation and model exchange simulation.","category":"page"},{"location":"examples/modelica_conference_2021/#Introduction-to-the-example","page":"Advanced Simulation of an FMU","title":"Introduction to the example","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"In this example we would like to show that besides the simple simulation of an FMU there is also a more advanced version of the simulation. The advantage of the more advanced variant is that there are more possibilities to intervene in the simulation to make changes. After the FMU has been simulated, the simulation results are displayed in a graph. The used model is a one-dimensional spring pendulum with friction. The object-orientated structure of the SpringFrictionPendulum1D can be seen in the following graphic.","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"(Image: svg)  ","category":"page"},{"location":"examples/modelica_conference_2021/#Target-group","page":"Advanced Simulation of an FMU","title":"Target group","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"The example is primarily intended for users who work in the field of simulations. The example wants to show how simple it is to use FMUs in Julia.","category":"page"},{"location":"examples/modelica_conference_2021/#Other-formats","page":"Advanced Simulation of an FMU","title":"Other formats","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"Besides, this Jupyter Notebook there is also a Julia file with the same name, which contains only the code cells and for the documentation there is a Markdown file corresponding to the notebook.  ","category":"page"},{"location":"examples/modelica_conference_2021/#Getting-started","page":"Advanced Simulation of an FMU","title":"Getting started","text":"","category":"section"},{"location":"examples/modelica_conference_2021/#Installation-prerequisites","page":"Advanced Simulation of an FMU","title":"Installation prerequisites","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":" Description Command Alternative\n1. Enter Package Manager via ] \n2. Install FMI via add FMI add \" https://github.com/ThummeTo/FMI.jl \"\n3. Install FMIZoo via add FMIZoo add \" https://github.com/ThummeTo/FMIZoo.jl \"\n4. Install Plots via add Plots ","category":"page"},{"location":"examples/modelica_conference_2021/#Code-section","page":"Advanced Simulation of an FMU","title":"Code section","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"To run the example, the previously installed packages must be included. ","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"# imports\nusing FMI\nusing FMIZoo\nusing Plots","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"┌ Warning: Replacing docs for `FMI.fmiPlot :: Tuple{FMICore.FMU2Solution}` in module `FMI`\n└ @ Base.Docs docs/Docs.jl:240","category":"page"},{"location":"examples/modelica_conference_2021/#Simulation-setup","page":"Advanced Simulation of an FMU","title":"Simulation setup","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"Next, the start time and end time of the simulation are set. Finally, a step size is specified to store the results of the simulation at these time steps.","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"tStart = 0.0\ntStep = 0.1\ntStop = 8.0\ntSave = tStart:tStep:tStop","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"0.0:0.1:8.0","category":"page"},{"location":"examples/modelica_conference_2021/#Simple-FMU-Simulation","page":"Advanced Simulation of an FMU","title":"Simple FMU Simulation","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"In the next lines of code the FMU model from FMIZoo.jl is loaded and the information about the FMU is shown.","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"# we use an FMU from the FMIZoo.jl\npathToFMU = get_model_filename(\"SpringFrictionPendulum1D\", \"Dymola\", \"2022x\")\n\nmyFMU = fmiLoad(pathToFMU)\nfmiInfo(myFMU)","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"┌ Info: fmi2Unzip(...): Successfully unzipped 29 files at `/tmp/fmijl_dg2hpy/SpringFrictionPendulum1D`.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:75\n┌ Info: fmi2Load(...): FMU resources location is `file:////tmp/fmijl_dg2hpy/SpringFrictionPendulum1D/resources`\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:190\n┌ Info: fmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:193\n\n\n#################### Begin information for FMU ####################\n\tModel name:\t\t\tSpringFrictionPendulum1D\n\tFMI-Version:\t\t\t2.0\n\tGUID:\t\t\t\t{df491d8d-0598-4495-913e-5b025e54d7f2}\n\tGeneration tool:\t\tDymola Version 2022x (64-bit), 2021-10-08\n\tGeneration time:\t\t2022-03-03T15:09:18Z\n\tVar. naming conv.:\t\tstructured\n\tEvent indicators:\t\t24\n\tInputs:\t\t\t\t0\n\tOutputs:\t\t\t0\n\tStates:\t\t\t\t2\n\t\t33554432 [\"mass.s\"]\n\t\t33554433 [\"mass.v\", \"mass.v_relfric\"]\n\tSupports Co-Simulation:\t\ttrue\n\t\tModel identifier:\tSpringFrictionPendulum1D\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n\t\tVar. com. steps:\ttrue\n\t\tInput interpol.:\ttrue\n\t\tMax order out. der.:\t1\n\tSupports Model-Exchange:\ttrue\n\t\tModel identifier:\tSpringFrictionPendulum1D\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n##################### End information for FMU #####################","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"In the next commands the FMU is simulated, for which the start and end time and recorded variables are declared. Afterwards the simulation result is shown in a graph. In the plot for the FMU, it can be seen that the oscillation keeps decreasing due to the effect of friction. If one simulates long enough, the oscillation comes to a standstill after a certain time.","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"simData = fmiSimulate(myFMU, tStart, tStop; recordValues=[\"mass.s\"], saveat=tSave)\nfmiPlot(simData)","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"(Image: svg)","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"After plotting the data, the FMU is unloaded and all unpacked data on disc is removed.","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"fmiUnload(myFMU)","category":"page"},{"location":"examples/modelica_conference_2021/#Advanced-FMU-Simulation","page":"Advanced Simulation of an FMU","title":"Advanced FMU Simulation","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"In the following type of simulation a more advanced variant is presented, which allows intervening more in the simulation process. Analogous to the simple variant, an FMU model must be loaded.","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"myFMU = fmiLoad(pathToFMU);","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"┌ Info: fmi2Unzip(...): Successfully unzipped 29 files at `/tmp/fmijl_HuQTow/SpringFrictionPendulum1D`.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:75\n┌ Info: fmi2Load(...): FMU resources location is `file:////tmp/fmijl_HuQTow/SpringFrictionPendulum1D/resources`\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:190\n┌ Info: fmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/S8pFT/src/FMI2_ext.jl:193","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"Next, it is necessary to create an instance of the FMU, this is achieved by the command fmiInstantiate!().  ","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"instanceFMU = fmiInstantiate!(myFMU)","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"FMU:            SpringFrictionPendulum1D\nInstanceName:   [not defined]\nAddress:        Ptr{Nothing} @0x0000000005fcca40\nState:          fmi2ComponentStateInstantiated\nLogging:        false\nFMU time:       -Inf\nFMU states:     nothing","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"In the following code block, start and end time for the simulation is set by the fmiSetupExperiment() command. Next, the FMU is initialized by the calls of fmiEnterInitializationMode() and fmiExitInitializationMode(). It would also be possible to set initial states for the FMU between these two commands. ","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"fmiSetupExperiment(instanceFMU, tStart, tStop)\nfmiEnterInitializationMode(instanceFMU)\n# set initial model states\nfmiExitInitializationMode(instanceFMU)","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"0x00000000","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"The actual simulation loop is shown in the following block. Here a simulation step fmiDoStep() with the fixed step size tStep is executed. As indicated in the code by the comments, the input values and output values of the FMU could be changed in the simulation loop as desired, whereby the higher possibility of adjustments arises.","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"for t in tSave\n    # set model inputs \n    # ...\n    fmiDoStep(instanceFMU, tStep)\n    # get model outputs\n    # ...\nend","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"The instantiated FMU must be terminated and then the memory area for the instance can also be deallocated. The last step is to unload the FMU to remove all unpacked data on disc. ","category":"page"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"fmiTerminate(instanceFMU)\nfmiFreeInstance!(instanceFMU)\nfmiUnload(myFMU)","category":"page"},{"location":"examples/modelica_conference_2021/#Summary","page":"Advanced Simulation of an FMU","title":"Summary","text":"","category":"section"},{"location":"examples/modelica_conference_2021/","page":"Advanced Simulation of an FMU","title":"Advanced Simulation of an FMU","text":"The tutorial has shown that besides the usual simple variant of simulating an FMU, there is another way to make more adjustments.","category":"page"},{"location":"library/fmu/#Version-independent-FMU-functions","page":"FMU version independent functions","title":"Version independent FMU functions","text":"","category":"section"},{"location":"library/fmu/#Parsing-variable-names-to-ValueReferences","page":"FMU version independent functions","title":"Parsing variable names to ValueReferences","text":"","category":"section"},{"location":"library/fmu/","page":"FMU version independent functions","title":"FMU version independent functions","text":"fmiStringToValueReference","category":"page"},{"location":"library/fmu/#FMI.fmiStringToValueReference","page":"FMU version independent functions","title":"FMI.fmiStringToValueReference","text":"fmiStringToValueReference(dataStruct::Union{FMU2, fmi2ModelDescription, FMU3, fmmi3ModelDescription}, identifier::Union{String, AbstractArray{String}})\n\nReturns the ValueReference coresponding to the variable identifier.\n\nArguments\n\ndataStruct::Union{FMU2, fmi2ModelDescription, FMU3, fmmi3ModelDescription}: Model of the type FMU2/FMU3 or the Model Description of fmi2/fmi3. Same for Model of type FMU3 or the Model Description of fmi3\nidentifier::Union{String, AbstractArray{String}}: Variable identifier in type String or as a 1-dimensional AbstractArray containing elements of type String\n\nSee also fmi2StringToValueReference, fmi3StringToValueReference.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#Opening-and-closing-FMUs","page":"FMU version independent functions","title":"Opening and closing FMUs","text":"","category":"section"},{"location":"library/fmu/","page":"FMU version independent functions","title":"FMU version independent functions","text":"fmiLoad\nfmiUnload","category":"page"},{"location":"library/fmu/#FMI.fmiLoad","page":"FMU version independent functions","title":"FMI.fmiLoad","text":"fmiLoad(pathToFMU::String; unpackPath=nothing, type=nothing)\n\nLoad FMUs independent of the FMI version, currently supporting version 2.0.X.\n\nArguments\n\npathToFMU::String: String that contains the paths of ziped and unziped FMU folders.\n\nKeywords\n\nunpackPath=nothing: Via optional argument unpackPath, a path to unpack the FMU can be specified (default: system temporary directory).\ntype::Union{CS, ME} = nothing:  Via type, a FMU type can be selected. If none of the unified type set is used, the default value type = nothing will be used.\n\nReturns\n\nReturns the instance of the FMU struct.\n\nSee also fmi2Load.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiUnload","page":"FMU version independent functions","title":"FMI.fmiUnload","text":"fmiUnload(fmu::FMU2)\n\nUnloads the FMU and all its instances and frees the allocated memory.\n\nArguments\n\nfmu::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\n\nSee also fmi2Unload.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#Reading-the-model-description","page":"FMU version independent functions","title":"Reading the model description","text":"","category":"section"},{"location":"library/fmu/","page":"FMU version independent functions","title":"FMU version independent functions","text":"fmiGetModelName\nfmiGetGUID\nfmiGetGenerationTool\nfmiGetGenerationDateAndTime\nfmiGetVariableNamingConvention\nfmiGetNumberOfEventIndicators\nfmiCanGetSetState\nfmiCanSerializeFMUstate\nfmiProvidesDirectionalDerivative\nfmiIsCoSimulation\nfmiIsModelExchange\nfmiInfo","category":"page"},{"location":"library/fmu/#FMI.fmiGetModelName","page":"FMU version independent functions","title":"FMI.fmiGetModelName","text":"fmiGetModelName(str::Union{fmi2StructMD, fmi3StructMD})\n\nReturns the tag 'modelName' from the model description.\n\nArguments\n\nstr::Union{fmi2StructMD, fmi3StructMD}:  Representative for an FMU in the FMI 2.0.2 Standard or FMI 3.0 Standard. Other notation:\n\nUnion{fmi2StructMD, fmi3StructMD} = Union{FMU2, FMU2Component, fmi2ModelDescription, FMU3, FMU3Component, fmi3ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct wich provides the static information of ModelVariables.\nstr::FMU3: Mutable struct representing an FMU in the FMI 3.0 Standard.\nstr::FMU3Component:  Mutable struct represents a pointer to an FMU specific data structure that contains the information needed. Also in FMI 3.0 Standard.\nstr::fmi3ModelDescription: Struct witch provides the static information of ModelVariables.\n\nSee also FMU2, FMU2Component, fmi2ModelDescription, FMU3, FMU3Component, fmi3ModelDescription.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiGetGUID","page":"FMU version independent functions","title":"FMI.fmiGetGUID","text":"fmiGetGUID(str::fmi2StructMD)\n\nReturns the tag 'guid' from the model description.\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard. More detailed:  fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct wich provides the static information of ModelVariables.\n\nSee also fmi2GetGUID, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.  \n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiGetGenerationTool","page":"FMU version independent functions","title":"FMI.fmiGetGenerationTool","text":"fmiGetGenerationTool(str::fmi2StructMD)\n\nReturns the tag 'generationtool' from the model description.\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed:  fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct wich provides the static information of ModelVariables.\n\nReturns\n\nstr.generationtool: The function fmi2GetGenerationTool returns the tag 'generationtool' from the struct, representing a FMU (str).\n\nSee also fmi2GetGenerationTool, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.  \n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiGetGenerationDateAndTime","page":"FMU version independent functions","title":"FMI.fmiGetGenerationDateAndTime","text":"fmiGetGenerationDateAndTime(str::fmi2StructMD)\n\nReturns the tag 'generationdateandtime' from the model description.\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed:  fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct witch provides the static information of ModelVariables.\n\nReturns\n\nstr.generationDateAndTime: The function fmi2GetGenerationDateAndTime returns the tag 'generationDateAndTime' from the struct, representing a FMU (str).\n\nSee also fmi2GetGenerationDateAndTime, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.  \n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiGetVariableNamingConvention","page":"FMU version independent functions","title":"FMI.fmiGetVariableNamingConvention","text":"fmiGetVariableNamingConvention(str::fmi2StructMD)\n\nReturns the tag 'varaiblenamingconvention' from the model description.\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed:  fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct witch provides the static information of ModelVariables.\n\nReturns\n\nstr.variableNamingConvention: The function fmi2GetVariableNamingConvention returns the tag 'variableNamingConvention' from the struct, representing a FMU (str).\n\nSee also fmi2GetVariableNamingConvention, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiGetNumberOfEventIndicators","page":"FMU version independent functions","title":"FMI.fmiGetNumberOfEventIndicators","text":"fmiGetNumberOfEventIndicators(str::fmi2StructMD)\n\nReturns the tag 'numberOfEventIndicators' from the model description.\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct witch provides the static information of ModelVariables.\n\nReturns\n\nstr.numberOfEventIndicators: The function fmi2GetNumberOfEventIndicators returns the tag 'numberOfEventIndicators' from the struct, representing a FMU (str).\n\nSee also fmi2GetNumberOfEventIndicators, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiCanGetSetState","page":"FMU version independent functions","title":"FMI.fmiCanGetSetState","text":"fmiCanGetSetState(str::fmi2StructMD)\n\nReturns true, if the FMU supports the getting/setting of states\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct witch provides the static information of ModelVariables.\n\nReturns\n\n::Bool: The function fmi2CanGetSetState returns True, if the FMU supports the getting/setting of states.\n\nSee also fmi2CanGetSetState, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiCanSerializeFMUstate","page":"FMU version independent functions","title":"FMI.fmiCanSerializeFMUstate","text":"fmiCanSerializeFMUstate(str::fmi2StructMD)\n\nReturns true, if the FMU state can be serialized\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct wich provides the static information of ModelVariables.\n\nReturns\n\n::Bool: The function fmi2CanSerializeFMUstate returns True, if the FMU state can be serialized.\n\nSee also fmi2CanSerializeFMUstate, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiProvidesDirectionalDerivative","page":"FMU version independent functions","title":"FMI.fmiProvidesDirectionalDerivative","text":"fmiProvidesDirectionalDerivative(str::fmi2StructMD)\n\nReturns true, if the FMU provides directional derivatives\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct witch provides the static information of ModelVariables.\n\nReturns\n\n::Bool: The function fmi2ProvidesDirectionalDerivative returns True, if the FMU provides directional derivatives.\n\nSee also fmi2ProvidesDirectionalDerivative, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiIsCoSimulation","page":"FMU version independent functions","title":"FMI.fmiIsCoSimulation","text":"fmiIsCoSimulation(str::fmi2StructMD)\n\nReturns true, if the FMU supports co simulation\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct witch provides the static information of ModelVariables.\n\nReturns\n\n::Bool: The function fmi2IsCoSimulation returns True, if the FMU supports co simulation\n\nSee also fmi2IsCoSimulation, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiIsModelExchange","page":"FMU version independent functions","title":"FMI.fmiIsModelExchange","text":"fmiIsModelExchange(str::fmi2StructMD)\n\nReturns true, if the FMU supports model exchange\n\nArguments\n\nstr::fmi2StructMD:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2StructMD =  Union{FMU2, FMU2Component, fmi2ModelDescription}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstr::fmi2ModelDescription: Struct witch provides the static information of ModelVariables.\n\nReturns\n\n::Bool: The function fmi2IsCoSimulation returns True, if the FMU supports model exchange.\n\nSee also fmi2IsModelExchange, fmi2StructMD, FMU2, FMU2Component, fmi2ModelDescription.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiInfo","page":"FMU version independent functions","title":"FMI.fmiInfo","text":"fmiInfo(str::fmi2Struct)\n\nPrints FMU-specific information into the REPL.\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\n\nSource\n\nFMISpec2.0.2 Link: https://fmi-standard.org/\n\nSee also fmi2Info, fmi2Struct, FMU2, FMU2Component.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#Simulate-FMU","page":"FMU version independent functions","title":"Simulate FMU","text":"","category":"section"},{"location":"library/fmu/","page":"FMU version independent functions","title":"FMU version independent functions","text":"fmiSimulate\nfmiSimulateCS\nfmiSimulateME\n","category":"page"},{"location":"library/fmu/#FMI.fmiSimulate","page":"FMU version independent functions","title":"FMI.fmiSimulate","text":"fmiSimulate(str::fmi2Struct, t_start::Union{Real, Nothing} = nothing, t_stop::Union{Real, Nothing} = nothing;\n            tolerance::Union{Real, Nothing} = nothing,\n            dt::Union{Real, Nothing} = nothing,\n            solver = nothing,\n            customFx = nothing,\n            recordValues::fmi2ValueReferenceFormat = nothing,\n            saveat = [],\n            setup::Bool = true,\n            reset::Union{Bool, Nothing} = nothing, # nothing = auto\n            inputValueReferences::fmi2ValueReferenceFormat = nothing,\n            inputFunction = nothing,\n            parameters::Union{Dict{<:Any, <:Any}, Nothing} = nothing,\n            dtmax::Union{Real, Nothing} = nothing,\n            kwargs...)\n\nStarts a simulation of the FMU instance for the matching FMU type, if both types are available, CS is preferred.\n\nArguments\n\nstr::fmi2Struct: Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nt_start::Union{Real, Nothing} = nothing: Set the start time to a value of type Real or the default value from the model description is used.\nt_stop::Union{Real, Nothing} = nothing: Set the end time to a value of type Real or the default value from the model description is used.\n\nKeywords\n\ntolerance::Union{Real, Nothing} = nothing: Real number to set the tolerance for any OED-solver\ndt::Union{Real, Nothing} = nothing: Real number to set the step size of the OED-solver. Defaults to an automatic choice if the method is adaptive. More Info: DifferentialEquations.jl Documentation\nsolver = nothing: Any Julia-supported OED-solver  (default is Tsit5). More Info: DifferentialEquations.jl Documentation\ncustomFx = nothing: [deperecated] Ability to give a custom state derivative function ẋ=f(x,t)\nrecordValues::fmi2ValueReferenceFormat = nothing: AbstractArray of variables (strings or variableIdentifiers) to record. Results are returned as DiffEqCallbacks.SavedValues\nsaveat = []: Time points to save values at (interpolated). More Info: DifferentialEquations.jl Documentation\nsetup::Bool = true: Boolean, if FMU should be setup (default: setup=true)\nreset::Union{Bool, Nothing} = nothing: Boolean, if FMU should be reset before simulation (default: reset:=auto)\ninputValueReferences::fmi2ValueReferenceFormat = nothing: AbstractArray of input variables (strings or variableIdentifiers) to set at every simulation step\ninputFunction = nothing: Function to retrieve the values to set the inputs to\nparameters::Union{Dict{<:Any, <:Any}, Nothing} = nothing: Dictionary of parameter variables (strings or variableIdentifiers) and values (Real, Integer, Boolean, String) to set parameters during initialization\ndtmax::Union{Real, Nothing} = nothing: Real number for setting maximum dt for adaptive timestepping for the ODE solver. The default values are package dependent. More Info: DifferentialEquations.jl Documentation\nkwargs...: Further parameters of already defined functions solve(args..., kwargs...) from the library DifferentialEquations.jl\n\nReturns\n\nsuccess::Bool for CS-FMUs  \nODESolution for ME-FMUs  \nif keyword recordValues is set, a tuple of type (success::Bool, DiffEqCallbacks.SavedValues) for CS-FMUs  \nif keyword recordValues is set, a tuple of type (ODESolution, DiffEqCallbacks.SavedValues) for ME-FMUs  \n\nSee also fmi2Simulate, fmi2SimulateME, fmi2SimulateCS, fmi2Struct, FMU2, FMU2Component.   \n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiSimulateCS","page":"FMU version independent functions","title":"FMI.fmiSimulateCS","text":"fmiSimulateCS(str::fmi2Struct, t_start::Union{Real, Nothing} = nothing, t_stop::Union{Real, Nothing} = nothing;\n            tolerance::Union{Real, Nothing} = nothing,\n            dt::Union{Real, Nothing} = nothing,\n            solver = nothing,\n            customFx = nothing,\n            recordValues::fmi2ValueReferenceFormat = nothing,\n            saveat = [],\n            setup::Bool = true,\n            reset::Union{Bool, Nothing} = nothing, # nothing = auto\n            inputValueReferences::fmi2ValueReferenceFormat = nothing,\n            inputFunction = nothing,\n            parameters::Union{Dict{<:Any, <:Any}, Nothing} = nothing,\n            dtmax::Union{Real, Nothing} = nothing,\n            kwargs...)\n\nStarts a simulation of the Co-Simulation FMU instance.\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nt_start::Union{Real, Nothing} = nothing: Set the start time to a value of type Real or the default value from the model description is used.\nt_stop::Union{Real, Nothing} = nothing: Set the end time to a value of type Real or the default value from the model description is used.\n\nKeywords\n\ntolerance::Union{Real, Nothing} = nothing: Real number to set the tolerance for any OED-solver\ndt::Union{Real, Nothing} = nothing: Real number to set the step size of the OED-solver. Defaults to an automatic choice if the method is adaptive. More Info: DifferentialEquations.jl Documentation\nsolver = nothing: Any Julia-supported OED-solver  (default is Tsit5). More Info: DifferentialEquations.jl Documentation\ncustomFx = nothing: [deperecated] Ability to give a custom state derivative function ẋ=f(x,t)\nrecordValues::fmi2ValueReferenceFormat = nothing: AbstractArray of variables (strings or variableIdentifiers) to record. Results are returned as DiffEqCallbacks.SavedValues\nsaveat = []: Time points to save values at (interpolated). More Info: DifferentialEquations.jl Documentation\nsetup::Bool = true: Boolean, if FMU should be setup (default: setup=true)\nreset::Union{Bool, Nothing} = nothing: Boolean, if FMU should be reset before simulation (default: reset:=auto)\ninputValueReferences::fmi2ValueReferenceFormat = nothing: AbstractArray of input variables (strings or variableIdentifiers) to set at every simulation step\ninputFunction = nothing: Function to retrieve the values to set the inputs to\nparameters::Union{Dict{<:Any, <:Any}, Nothing} = nothing: Dictionary of parameter variables (strings or variableIdentifiers) and values (Real, Integer, Boolean, String) to set parameters during initialization\ndtmax::Union{Real, Nothing} = nothing: Real number for setting maximum dt for adaptive timestepping for the ODE solver. The default values are package dependent. More Info: DifferentialEquations.jl Documentation\nkwargs...: Further parameters of already defined functions solve(args..., kwargs...) from the library DifferentialEquations.jl\n\nReturns\n\nIf keyword recordValues is not set, a boolean success is returned (simulation success).\nIf keyword recordValues is set, a tuple of type (true, DiffEqCallbacks.SavedValues) or (false, nothing).  \n\nSee also fmi2SimulateCS, fmi2Simulate, fmi2SimulateME, fmi2Struct, FMU2, FMU2Component.\n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#FMI.fmiSimulateME","page":"FMU version independent functions","title":"FMI.fmiSimulateME","text":"fmiSimulateME(str::fmi2Struct, t_start::Union{Real, Nothing} = nothing, t_stop::Union{Real, Nothing} = nothing;\n            tolerance::Union{Real, Nothing} = nothing,\n            dt::Union{Real, Nothing} = nothing,\n            solver = nothing,\n            customFx = nothing,\n            recordValues::fmi2ValueReferenceFormat = nothing,\n            saveat = [],\n            setup::Bool = true,\n            reset::Union{Bool, Nothing} = nothing, # nothing = auto\n            inputValueReferences::fmi2ValueReferenceFormat = nothing,\n            inputFunction = nothing,\n            parameters::Union{Dict{<:Any, <:Any}, Nothing} = nothing,\n            dtmax::Union{Real, Nothing} = nothing,\n            kwargs...)\n\nSimulates a FMU instance for the given simulation time interval.\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nt_start::Union{Real, Nothing} = nothing: Set the start time to a value of type Real or the default value from the model description is used.\nt_stop::Union{Real, Nothing} = nothing: Set the end time to a value of type Real or the default value from the model description is used.\n\nKeywords\n\ntolerance::Union{Real, Nothing} = nothing: Real number to set the tolerance for any OED-solver\ndt::Union{Real, Nothing} = nothing: Real number to set the step size of the OED-solver. Defaults to an automatic choice if the method is adaptive. More Info: DifferentialEquations.jl Documentation\nsolver = nothing: Any Julia-supported OED-solver  (default is Tsit5). More Info: DifferentialEquations.jl Documentation\ncustomFx = nothing: [deperecated] Ability to give a custom state derivative function ẋ=f(x,t)\nrecordValues::fmi2ValueReferenceFormat = nothing: AbstractArray of variables (strings or variableIdentifiers) to record. Results are returned as DiffEqCallbacks.SavedValues\nsaveat = []: Time points to save values at (interpolated). More Info: DifferentialEquations.jl Documentation\nsetup::Bool = true: Boolean, if FMU should be setup (default: setup=true)\nreset::Union{Bool, Nothing} = nothing: Boolean, if FMU should be reset before simulation (default: reset:=auto)\ninputValueReferences::fmi2ValueReferenceFormat = nothing: AbstractArray of input variables (strings or variableIdentifiers) to set at every simulation step\ninputFunction = nothing: Function to retrieve the values to set the inputs to\nparameters::Union{Dict{<:Any, <:Any}, Nothing} = nothing: Dictionary of parameter variables (strings or variableIdentifiers) and values (Real, Integer, Boolean, String) to set parameters during initialization\ndtmax::Union{Real, Nothing} = nothing: Real number for setting maximum dt for adaptive timestepping for the ODE solver. The default values are package dependent. More Info: DifferentialEquations.jl Documentation\nkwargs...: Further parameters of already defined functions solve(args..., kwargs...) from the library DifferentialEquations.jl\n\nReturns\n\nIf keyword recordValues is not set, a struct of type ODESolution.\nIf keyword recordValues is set, a tuple of type (ODESolution, DiffEqCallbacks.SavedValues).\n\nSee also fmi2SimulateME fmi2SimulateCS, fmi2Simulate, fmi2Struct, FMU2, FMU2Component.  \n\n\n\n\n\n","category":"function"},{"location":"library/fmu/#Visualize-simulation-results","page":"FMU version independent functions","title":"Visualize simulation results","text":"","category":"section"},{"location":"library/fmu/","page":"FMU version independent functions","title":"FMU version independent functions","text":"fmiPlot","category":"page"},{"location":"examples/parameterize/#Manually-parameterize-an-FMU","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Tutorial by Johannes Stoljar, Tobias Thummerer","category":"page"},{"location":"examples/parameterize/#License","page":"Manually parameterize an FMU","title":"License","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Copyright (c) 2021 Tobias Thummerer, Lars Mikelsons, Josef Kircher, Johannes Stoljar","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Licensed under the MIT license. See LICENSE file in the project root for details.","category":"page"},{"location":"examples/parameterize/#Motivation","page":"Manually parameterize an FMU","title":"Motivation","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"This Julia Package FMI.jl is motivated by the use of simulation models in Julia. Here the FMI specification is implemented. FMI (Functional Mock-up Interface) is a free standard (fmi-standard.org) that defines a container and an interface to exchange dynamic models using a combination of XML files, binaries and C code zipped into a single file. The user can thus use simulation models in the form of an FMU (Functional Mock-up Units). Besides loading the FMU, the user can also set values for parameters and states and simulate the FMU both as co-simulation and model exchange simulation.","category":"page"},{"location":"examples/parameterize/#Introduction-to-the-example","page":"Manually parameterize an FMU","title":"Introduction to the example","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"This example shows how the manually parameterization of an FMU works if very specific adjustments during system initialization is needed. For this purpose, an IO-FMU model is loaded and the various commands for parameterization are shown on the basis of this model. With this example the user shall be guided how to make certain settings at an FMU. Please note, that parameterization of a simulation is possible in a much easier fashion: Using fmiSimulate, fmiSimulateME or fmiSimulateCS together with a parameter dictionary for the keyword parameters.","category":"page"},{"location":"examples/parameterize/#Target-group","page":"Manually parameterize an FMU","title":"Target group","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"The example is primarily intended for users who work in the field of simulation exchange. The example wants to show how simple it is to use FMUs in Julia.","category":"page"},{"location":"examples/parameterize/#Other-formats","page":"Manually parameterize an FMU","title":"Other formats","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Besides, this Jupyter Notebook there is also a Julia file with the same name, which contains only the code cells and for the documentation there is a Markdown file corresponding to the notebook.  ","category":"page"},{"location":"examples/parameterize/#Getting-started","page":"Manually parameterize an FMU","title":"Getting started","text":"","category":"section"},{"location":"examples/parameterize/#Installation-prerequisites","page":"Manually parameterize an FMU","title":"Installation prerequisites","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":" Description Command Alternative\n1. Enter Package Manager via ] \n2. Install FMI via add FMI add \" https://github.com/ThummeTo/FMI.jl \"\n3. Install FMIZoo via add FMIZoo add \" https://github.com/ThummeTo/FMIZoo.jl \"","category":"page"},{"location":"examples/parameterize/#Code-section","page":"Manually parameterize an FMU","title":"Code section","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"To run the example, the previously installed packages must be included. ","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"# imports\nusing FMI\nusing FMIZoo","category":"page"},{"location":"examples/parameterize/#Simulation-setup","page":"Manually parameterize an FMU","title":"Simulation setup","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Next, the start time and end time of the simulation are set.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"tStart = 0.0\ntStop = 8.0","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"8.0","category":"page"},{"location":"examples/parameterize/#Import-FMU","page":"Manually parameterize an FMU","title":"Import FMU","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"In the next lines of code the FMU model from FMIZoo.jl is loaded and the information about the FMU is shown.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"# we use an FMU from the FMIZoo.jl\npathToFMU = get_model_filename(\"IO\", \"Dymola\", \"2022x\")\n\nmyFMU = fmiLoad(pathToFMU)\nfmiInfo(myFMU)","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"┌ Info: fmi2Unzip(...): Successfully unzipped 29 files at `/tmp/fmijl_E6omKF/IO`.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/OUODz/src/FMI2_ext.jl:75\n┌ Info: fmi2Load(...): FMU resources location is `file:////tmp/fmijl_E6omKF/IO/resources`\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/OUODz/src/FMI2_ext.jl:190\n┌ Info: fmi2Load(...): FMU supports both CS and ME, using CS as default if nothing specified.\n└ @ FMIImport /home/runner/.julia/packages/FMIImport/OUODz/src/FMI2_ext.jl:193\n\n\n#################### Begin information for FMU ####################\n\tModel name:\t\t\tIO\n\tFMI-Version:\t\t\t2.0\n\tGUID:\t\t\t\t{ac3b4a99-4908-40f7-89da-2d5c08b3c4ac}\n\tGeneration tool:\t\tDymola Version 2022x (64-bit), 2021-10-08\n\tGeneration time:\t\t2022-03-17T07:40:55Z\n\tVar. naming conv.:\t\tstructured\n\tEvent indicators:\t\t4\n\tInputs:\t\t\t\t3\n\t\t352321536 [\"u_real\"]\n\t\t352321537 [\"u_boolean\"]\n\t\t352321538 [\"u_integer\"]\n\tOutputs:\t\t\t3\n\t\t335544320 [\"y_real\"]\n\t\t335544321 [\"y_boolean\"]\n\t\t335544322 [\"y_integer\"]\n\tStates:\t\t\t\t0\n\tSupports Co-Simulation:\t\ttrue\n\t\tModel identifier:\tIO\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n\t\tVar. com. steps:\ttrue\n\t\tInput interpol.:\ttrue\n\t\tMax order out. der.:\t1\n\tSupports Model-Exchange:\ttrue\n\t\tModel identifier:\tIO\n\t\tGet/Set State:\t\ttrue\n\t\tSerialize State:\ttrue\n\t\tDir. Derivatives:\ttrue\n##################### End information for FMU #####################","category":"page"},{"location":"examples/parameterize/#Instantiate-and-Setup-FMU","page":"Manually parameterize an FMU","title":"Instantiate and Setup FMU","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Next it is necessary to create an instance of the FMU. This is achieved by the command fmiInstantiate!().","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"fmiInstantiate!(myFMU; loggingOn=true)","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"FMU:            IO\nInstanceName:   [not defined]\nAddress:        Ptr{Nothing} @0x0000000003ae6b10\nState:          fmi2ComponentStateInstantiated\nLogging:        false\nFMU time:       -Inf\nFMU states:     nothing","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"In the following code block, start and end time for the simulation is set by the fmiSetupExperiment() command.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"fmiSetupExperiment(myFMU, tStart, tStop)","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"0x00000000","category":"page"},{"location":"examples/parameterize/#Parameterize-FMU","page":"Manually parameterize an FMU","title":"Parameterize FMU","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"To parameterize an FMU, the FMU must be in the initialization mode, which is reached with the fmiEnterInitializationMode() command.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"fmiEnterInitializationMode(myFMU)","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"0x00000000","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Within this mode it is then possible to change the different parameters. In this example, for each data type (real, integer, boolean and string) a corresponding parameter is selected. At the beginning the initial state of these parameters is displayed with fmiGet().","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"params = [\"p_real\", \"p_integer\", \"p_boolean\", \"p_string\"]\nfmiGet(myFMU, params)","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"4-element Vector{Any}:\n 0.0\n 0\n 0\n  \"Hello World!\"","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"In the next step, a function is defined that generates a random value for each parameter. For the parameter p_string a random number is inserted into the string. All parameters are combined to a vector and output.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"function generateRandomNumbers()\n    rndReal = 100 * rand()\n    rndInteger = round(Integer, 100 * rand())\n    rndBoolean = rand() > 0.5\n    rndString = \"Random number $(100 * rand())!\"\n\n    randValues = [rndReal, rndInteger, rndBoolean, rndString]\n    println(randValues)\n    return randValues\nend","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"generateRandomNumbers (generic function with 1 method)","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"The previously defined function is called and the results are displayed in the console.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"paramsVal = generateRandomNumbers();","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Any[41.68976766058903, 91, false, \"Random number 18.117421661942835!\"]","category":"page"},{"location":"examples/parameterize/#First-variant","page":"Manually parameterize an FMU","title":"First variant","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"With this variant it is quickly possible to set all parameters at once. Even different data types can be set with only one command. The command fmiSet() selects itself which function is chosen for which data type. After setting the parameters, it is checked whether the corresponding parameters were set correctly. For this the function fmiGet() is used as above and afterwards with the macro @assert also tested whether the correct values are set.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"fmiSet(myFMU, params, paramsVal)\nvalues = fmiGet(myFMU, params)\nprint(values)\n\n@assert paramsVal == values","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Any[41.68976766058903, 91, 0, \"Random number 18.117421661942835!\"]","category":"page"},{"location":"examples/parameterize/#Second-variant","page":"Manually parameterize an FMU","title":"Second variant","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"To make sure that the functions work it is necessary to generate random numbers again. As shown already, we call the defined function generateRandomNumbers() and output the values.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"rndReal, rndInteger, rndBoolean, rndString = generateRandomNumbers();","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Any[32.87773039642885, 58, false, \"Random number 22.4054218867213!\"]","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"In the second variant, the value for each data type is set separately by the corresponding command. By this variant one has the maximum control and can be sure that also the correct data type is set. To illustrate the functionality of the parameterization with the separate functions, the corresponding get function is also called separately for each data type:","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"fmiSetReal() <–-> fmiGetReal()\nfmiSetInteger() <–-> fmiGetInteger()\nfmiSetBoolean() <–-> fmiGetBoolean()\nfmiSetString() <–-> fmiGetString().","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"fmiSetReal(myFMU, \"p_real\", rndReal)\ndisplay(\"$rndReal == $(fmiGetReal(myFMU, \"p_real\"))\")\n\nfmiSetInteger(myFMU, \"p_integer\", rndInteger)\ndisplay(\"$rndInteger == $(fmiGetInteger(myFMU, \"p_integer\"))\")\n\nfmiSetBoolean(myFMU, \"p_boolean\", rndBoolean)\ndisplay(\"$rndBoolean == $(fmiGetBoolean(myFMU, \"p_boolean\"))\")\n\nfmiSetString(myFMU, \"p_string\", rndString)\ndisplay(\"$rndString == $(fmiGetString(myFMU, \"p_string\"))\")","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"\"32.87773039642885 == 32.87773039642885\"\n\n\n\n\"58 == 58\"\n\n\n\n\"false == 0\"\n\n\n\n\"Random number 22.4054218867213! == Random number 22.4054218867213!\"","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"After seeing that both variants set the parameters correctly, the initialization mode is terminated with the function fmiExitInitializationMode().","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"fmiExitInitializationMode(myFMU)","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"0x00000000","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"From here on, you may want to simulate the FMU. Please note, that with the default executionConfig, it is necessary to prevent a new instantiation using the keyword instantiate=false. Otherwise, a new instance is allocated for the simulation-call and the parameters set for the previous instance are not transfered.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Example: fmiSimulate(...; instantiate=false, ...)","category":"page"},{"location":"examples/parameterize/#Unload-FMU","page":"Manually parameterize an FMU","title":"Unload FMU","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"The FMU will be unloaded and all unpacked data on disc will be removed.","category":"page"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"fmiUnload(myFMU)","category":"page"},{"location":"examples/parameterize/#Summary","page":"Manually parameterize an FMU","title":"Summary","text":"","category":"section"},{"location":"examples/parameterize/","page":"Manually parameterize an FMU","title":"Manually parameterize an FMU","text":"Based on this tutorial it can be seen that there are two different variants to set and get parameters.These examples should make it clear to the user how parameters can also be set with different data types.","category":"page"},{"location":"#FMI.jl-Documentation","page":"Introduction","title":"FMI.jl Documentation","text":"","category":"section"},{"location":"#What-is-FMI.jl?","page":"Introduction","title":"What is FMI.jl?","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"FMI.jl is a free-to-use software library for the Julia programming language, which integrates FMI (fmi-standard.org): load, instantiate, parameterize and simulate FMUs seamlessly inside the Julia programming language!","category":"page"},{"location":"#How-can-I-install-FMI.jl?","page":"Introduction","title":"How can I install FMI.jl?","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"open a Julia-Command-Window, activate your preferred environment\ngo to package manager using ] and type add FMI","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"julia> ]\n\n(@v1.6) pkg> add FMI","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"If you want to check that everything works correctly, you can run the tests bundled with FMI.jl:","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"julia> using Pkg\n\njulia> Pkg.test(\"FMI\")","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"Additionally, you can check the version of FMI.jl that you have installed with the status command.","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"julia> ]\n(@v1.6) pkg> status FMI","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"Throughout the rest of the tutorial we assume that you have installed the FMI.jl package and have typed using FMI which loads the package:","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"julia> using FMI","category":"page"},{"location":"#How-the-documentation-is-structured?","page":"Introduction","title":"How the documentation is structured?","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"Having a high-level overview of how this documentation is structured will help you know where to look for certain things. The xxx main parts of the documentation are :","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"The Examples section gives insight in what is possible with this Library while using short and easily understandable code snippets\nThe Library Functions sections contains all the documentation to the functions provided by this library","category":"page"},{"location":"#What-is-currently-supported-in-FMI.jl?","page":"Introduction","title":"What is currently supported in FMI.jl?","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"simulation / plotting of CS- and ME-FMUs\nevent-handling for discontinuous ME-FMUs\nthe full FMI command set","category":"page"},{"location":"#What-is-under-development-in-FMI.jl?","page":"Introduction","title":"What is under development in FMI.jl?","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"FMI 3.0 and SSP 1.0 support\nFMI Cross Checks\nmore examples\n...","category":"page"},{"location":"#What-Platforms-are-supported?","page":"Introduction","title":"What Platforms are supported?","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"FMI.jl is tested (and testing) under Julia Version 1.6 and latest on Windows (latest) and Ubuntu (latest). Mac should work, but untested.","category":"page"},{"location":"#How-to-cite?-Related-publications?","page":"Introduction","title":"How to cite? Related publications?","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"Tobias Thummerer, Josef Kircher, Lars Mikelsons 2021 NeuralFMU: Towards Structural Integration of FMUs into Neural Networks (14th Modelica Conference, Preprint, Accepted) arXiv:2109.04351","category":"page"},{"location":"","page":"Introduction","title":"Introduction","text":"Tobias Thummerer, Johannes Tintenherr, Lars Mikelsons 2021 Hybrid modeling of the human cardiovascular system using NeuralFMUs (10th International Conference on Mathematical Modeling in Physical Sciences, Preprint, Accepted) arXiv:2109.04880","category":"page"},{"location":"#Interested-in-Hybrid-Modeling-in-Julia-using-FMUs?","page":"Introduction","title":"Interested in Hybrid Modeling in Julia using FMUs?","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"See FMIFlux.jl.","category":"page"},{"location":"#FMI.jl-Library-Index","page":"Introduction","title":"FMI.jl Library Index","text":"","category":"section"},{"location":"","page":"Introduction","title":"Introduction","text":"","category":"page"},{"location":"library/library/#Version-independent-library-functions","page":"FMI version independent library functions","title":"Version independent library functions","text":"","category":"section"},{"location":"library/library/#Creation,-Destruction-FMU","page":"FMI version independent library functions","title":"Creation, Destruction FMU","text":"","category":"section"},{"location":"library/library/","page":"FMI version independent library functions","title":"FMI version independent library functions","text":"fmiInstantiate!\nfmiFreeInstance!","category":"page"},{"location":"library/library/#FMI.fmiInstantiate!","page":"FMI version independent library functions","title":"FMI.fmiInstantiate!","text":"fmiInstantiate!(fmu::FMU2; pushComponents::Bool = true, visible::Bool = false, loggingOn::Bool = false, externalCallbacks::Bool = false,\n                      logStatusOK::Bool=true, logStatusWarning::Bool=true, logStatusDiscard::Bool=true, logStatusError::Bool=true, logStatusFatal::Bool=true, logStatusPending::Bool=true)\n\nCreates a new instance of the FMU, version independent.\n\nCreate a new instance of the given fmu, adds a logger if logginOn == true.\n\nArguments\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\n\nKeywords\n\npushComponents::Bool = true:  pushComponents if the item component should be inserted in fmu.components(default = true).\nvisible::Bool = false: visible if the FMU should be started with graphic interface, if supported (default=false)\nloggingOn::Bool = false: loggingOn if the FMU should log and display function calls (default=false)\nexternalCallbacks::Bool = false: externalCallbacks if an external DLL should be used for the fmi2CallbackFunctions, this may improve readability of logging messages (default=false)\nlogStatusOK::Bool=true: logStatusOK whether to log status of kind fmi2OK (default=true)\nlogStatusWarning::Bool=true: logStatusWarning whether to log status of kind fmi2Warning (default=true)\nlogStatusDiscard::Bool=true: logStatusDiscard whether to log status of kind fmi2Discard (default=true)\nlogStatusError::Bool=true: logStatusError whether to log status of kind fmi2Error (default=true)\nlogStatusFatal::Bool=true: logStatusFatal whether to log status of kind fmi2Fatal (default=true)\nlogStatusPending::Bool=true: logStatusPending whether to log status of kind fmi2Pending (default=true)\n\nReturns\n\nnothing: if the instantiation failed. In addition, an error message appears.\ncomponent: Returns the instance of a new FMU component.\n\nSource\n\nFMISpec2.0.2 Link: https://fmi-standard.org/\nFMISpec2.0.2[p.19]: 2.1.5 Creation, Destruction and Logging of FMU Instances\n\nSee also fmi2Instantiate!, fmi2Instantiate, FMU2.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiFreeInstance!","page":"FMI version independent library functions","title":"FMI.fmiFreeInstance!","text":"fmiFreeInstance!(str::fmi2Struct)\n\nFrees the allocated memory of the last instance of the FMU.\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\n\nReturns\n\nstatus::fmi2Status: returned by all functions to indicate the success of the function call\n\nSource\n\nFMISpec2.0.2 Link: https://fmi-standard.org/\nFMISpec2.0.2[p.23]: 2.1.6 Initialization, Termination, and Resetting an FMU\nFMISpec2.0.2[p.18]: 2.1.3 Status Returned by Functions\n\nSee also fmi2FreeInstance, fmi2Struct, FMU2, FMU2Component.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#Platform-and-Version-number","page":"FMI version independent library functions","title":"Platform and Version number","text":"","category":"section"},{"location":"library/library/","page":"FMI version independent library functions","title":"FMI version independent library functions","text":"fmiGetTypesPlatform\nfmiGetVersion\nfmiSetDebugLogging","category":"page"},{"location":"library/library/#FMI.fmiGetTypesPlatform","page":"FMI version independent library functions","title":"FMI.fmiGetTypesPlatform","text":"fmiGetTypesPlatform(str::fmi2Struct)\n\nReturns the header file used to compile the FMU. By default returns default, version independent.\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\n\nReturns\n\n\n\nSee also fmi2GetVersion, fmi2Struct, FMU2, FMU2Component.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetVersion","page":"FMI version independent library functions","title":"FMI.fmiGetVersion","text":"fmiGetVersion(str::fmi2Struct)\n\nReturns the version of the FMU, version independent.\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\n\nReturns\n\nReturns a string from the address of a C-style (NUL-terminated) string. The string represents the version of the “fmi2Functions.h” header file which was used to compile the functions of the FMU. The function returns “fmiVersion” which is defined in this header file. The standard header file as documented in this specification has version “2.0”\n\nSource\n\nFMISpec2.0.2 Link: https://fmi-standard.org/\nFMISpec2.0.2[p.22]: 2.1.4 Inquire Platform and Version Number of Header Files\nFMISpec2.0.2[p.16]: 2.1.2 Platform Dependent Definitions\n\nSee also fmi2GetVersion, unsafe_string, fmi2Struct, FMU2, FMU2Component.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiSetDebugLogging","page":"FMI version independent library functions","title":"FMI.fmiSetDebugLogging","text":"fmiSetDebugLogging(str::fmi2Struct)\n\nControl the use of the logging callback function, version independent.\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\n\nSource\n\nFMISpec2.0.2 Link: https://fmi-standard.org/\nFMISpec2.0.2[p.22]: 2.1.5 Creation, Destruction and Logging of FMU Instances\n\n\n\n\n\n","category":"function"},{"location":"library/library/#Initialization,-Termination-and-Destruction","page":"FMI version independent library functions","title":"Initialization, Termination and Destruction","text":"","category":"section"},{"location":"library/library/","page":"FMI version independent library functions","title":"FMI version independent library functions","text":"fmiSetupExperiment\nfmiEnterInitializationMode\nfmiExitInitializationMode\nfmiTerminate\nfmiReset","category":"page"},{"location":"library/library/#FMI.fmiSetupExperiment","page":"FMI version independent library functions","title":"FMI.fmiSetupExperiment","text":"fmiSetupExperiment(str::fmi2Struct, c::FMU2Component, startTime::Union{Real, Nothing} = nothing, stopTime::Union{Real, Nothing} = nothing; tolerance::Union{Real, Nothing} = nothing)\n\nInitialize the Simulation boundries\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\nstartTime::Union{Real, Nothing} = nothing: startTime is a real number which sets the value of starting time of the experiment. The default value is set automatically if doing nothing (default = nothing).\nstopTime::Union{Real, Nothing} = nothing: stopTime is a real number which sets the value of ending time of the experiment. The default value is set automatically if doing nothing (default = nothing).\n\nKeywords\n\ntolerance::Union{Real, Nothing} = nothing: tolerance is a real number which sets the value of tolerance range. The default value is set automatically if doing nothing (default = nothing).\n\nReturns\n\nReturns a warning if str.state is not called in fmi2ComponentStateInstantiated.\nstatus::fmi2Status: returned by all functions to indicate the success of the function call\n\nSource\n\nFMISpec2.0.2 Link: https://fmi-standard.org/\nFMISpec2.0.2[p.23]: 2.1.6 Initialization, Termination, and Resetting an FMU\nFMISpec2.0.2[p.18]: 2.1.3 Status Returned by Functions\n\nSee also fmi2SetupExperiment, fmi2Struct, FMU2, FMU2Component.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiEnterInitializationMode","page":"FMI version independent library functions","title":"FMI.fmiEnterInitializationMode","text":"fmiEnterInitializationMode(str::fmi2Struct)\n\nInforms the FMU to enter initializaton mode, version independent.\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\n\nReturns\n\nReturns a warning if str.state is not called in fmi2ComponentStateInstantiated.\nstatus::fmi2Status: returned by all functions to indicate the success of the function call\n\nSource\n\nFMISpec2.0.2 Link: https://fmi-standard.org/\nFMISpec2.0.2[p.23]: 2.1.6 Initialization, Termination, and Resetting an FMU\nFMISpec2.0.2[p.18]: 2.1.3 Status Returned by Functions\n\nSee also fmi2EnterInitializationMode, fmi2Struct, FMU2, FMU2Component.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiExitInitializationMode","page":"FMI version independent library functions","title":"FMI.fmiExitInitializationMode","text":"fmiExitInitializationMode(str::fmi2Struct)\n\nInforms the FMU to exit initialization mode, version independent.\n\nArguments\n\nstr::fmi2Struct:  Representative for an FMU in the FMI 2.0.2 Standard.\n\nMore detailed: fmi2Struct = Union{FMU2, FMU2Component}\n\nstr::FMU2: Mutable struct representing a FMU and all it instantiated instances in the FMI 2.0.2 Standard.\nstr::FMU2Component: Mutable struct represents an instantiated instance of an FMU in the FMI 2.0.2 Standard.\n\nReturns\n\nReturns a warning if str.state is not called in fmi2ComponentStateInitializationMode.\nstatus::fmi2Status: returned by all functions to indicate the success of the function call\n\nSource\n\nFMISpec2.0.2 Link: https://fmi-standard.org/\nFMISpec2.0.2[p.23]: 2.1.6 Initialization, Termination, and Resetting an FMU\nFMISpec2.0.2[p.18]: 2.1.3 Status Returned by Functions\n\nSee also fmi2ExitInitializationMode\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiTerminate","page":"FMI version independent library functions","title":"FMI.fmiTerminate","text":"Informs the FMU that the simulation run is terminated, version independent.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiReset","page":"FMI version independent library functions","title":"FMI.fmiReset","text":"Resets the FMU after a simulation run, version independent.\n\n\n\n\n\n","category":"function"},{"location":"library/library/#Get/Set-variable-values","page":"FMI version independent library functions","title":"Get/Set variable values","text":"","category":"section"},{"location":"library/library/","page":"FMI version independent library functions","title":"FMI version independent library functions","text":"fmiGetReal\nfmiGetReal!\nfmiSetReal\nfmiGetInteger\nfmiGetInteger!\nfmiSetInteger\nfmiGetBoolean\nfmiGetBoolean!\nfmiSetBoolean\nfmiGetString\nfmiGetString!\nfmiSetString","category":"page"},{"location":"library/library/#FMI.fmiGetReal","page":"FMI version independent library functions","title":"FMI.fmiGetReal","text":"Returns the real values of an array of variables\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetReal!","page":"FMI version independent library functions","title":"FMI.fmiGetReal!","text":"Writes the real values of an array of variables in the given field\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiSetReal","page":"FMI version independent library functions","title":"FMI.fmiSetReal","text":"Set the values of an array of real variables\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetInteger","page":"FMI version independent library functions","title":"FMI.fmiGetInteger","text":"Returns the integer values of an array of variables\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetInteger!","page":"FMI version independent library functions","title":"FMI.fmiGetInteger!","text":"Writes the integer values of an array of variables in the given field\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiSetInteger","page":"FMI version independent library functions","title":"FMI.fmiSetInteger","text":"Set the values of an array of integer variables\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetBoolean","page":"FMI version independent library functions","title":"FMI.fmiGetBoolean","text":"Returns the boolean values of an array of variables\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetBoolean!","page":"FMI version independent library functions","title":"FMI.fmiGetBoolean!","text":"Writes the boolean values of an array of variables in the given field\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiSetBoolean","page":"FMI version independent library functions","title":"FMI.fmiSetBoolean","text":"Set the values of an array of boolean variables\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetString","page":"FMI version independent library functions","title":"FMI.fmiGetString","text":"Returns the string values of an array of variables\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetString!","page":"FMI version independent library functions","title":"FMI.fmiGetString!","text":"Writes the string values of an array of variables in the given field\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiSetString","page":"FMI version independent library functions","title":"FMI.fmiSetString","text":"Set the values of an array of string variables\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMU-state-Functions","page":"FMI version independent library functions","title":"FMU state Functions","text":"","category":"section"},{"location":"library/library/","page":"FMI version independent library functions","title":"FMI version independent library functions","text":"fmiGetFMUstate\nfmiSetFMUstate\nfmiFreeFMUstate!\nfmiSerializedFMUstateSize\nfmiSerializeFMUstate\nfmiDeSerializeFMUstate","category":"page"},{"location":"library/library/#FMI.fmiGetFMUstate","page":"FMI version independent library functions","title":"FMI.fmiGetFMUstate","text":"Returns the FMU state of the fmu\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiSetFMUstate","page":"FMI version independent library functions","title":"FMI.fmiSetFMUstate","text":"Sets the FMU to the given state\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiFreeFMUstate!","page":"FMI version independent library functions","title":"FMI.fmiFreeFMUstate!","text":"Free the memory for the allocated FMU state\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiSerializedFMUstateSize","page":"FMI version independent library functions","title":"FMI.fmiSerializedFMUstateSize","text":"Returns the size of the byte vector the FMU can be stored in\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiSerializeFMUstate","page":"FMI version independent library functions","title":"FMI.fmiSerializeFMUstate","text":"Serialize the data in the FMU state pointer\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiDeSerializeFMUstate","page":"FMI version independent library functions","title":"FMI.fmiDeSerializeFMUstate","text":"Deserialize the data in the FMU state pointer\n\n\n\n\n\n","category":"function"},{"location":"library/library/#Partial-Derivatives","page":"FMI version independent library functions","title":"Partial Derivatives","text":"","category":"section"},{"location":"library/library/","page":"FMI version independent library functions","title":"FMI version independent library functions","text":"fmiGetDirectionalDerivative(::FMI.fmi2Struct, ::Array{Cint}, ::Array{Cint}, ::Array{Real}, ::Array{Real})","category":"page"},{"location":"library/library/#FMI.fmiGetDirectionalDerivative-Tuple{Union{FMU2, FMU2Component}, Array{Int32, N} where N, Array{Int32, N} where N, Array{Real, N} where N, Array{Real, N} where N}","page":"FMI version independent library functions","title":"FMI.fmiGetDirectionalDerivative","text":"Returns the values of the directional derivatives.\n\n\n\n\n\n","category":"method"},{"location":"library/library/#CoSimulation-specific-Functions","page":"FMI version independent library functions","title":"CoSimulation specific Functions","text":"","category":"section"},{"location":"library/library/","page":"FMI version independent library functions","title":"FMI version independent library functions","text":"fmiDoStep(::FMI.fmi2Struct, ::Real)","category":"page"},{"location":"library/library/#FMI.fmiDoStep-Tuple{Union{FMU2, FMU2Component}, Real}","page":"FMI version independent library functions","title":"FMI.fmiDoStep","text":"Does one step in the CoSimulation FMU\n\n\n\n\n\n","category":"method"},{"location":"library/library/#ModelExchange-specific-Functions","page":"FMI version independent library functions","title":"ModelExchange specific Functions","text":"","category":"section"},{"location":"library/library/","page":"FMI version independent library functions","title":"FMI version independent library functions","text":"fmiSetTime\nfmiSetContinuousStates\nfmiNewDiscreteStates\nfmiEnterContinuousTimeMode\nfmiCompletedIntegratorStep\nfmiGetDerivatives\nfmiGetEventIndicators\nfmiGetContinuousStates\nfmiGetNominalsOfContinuousStates","category":"page"},{"location":"library/library/#FMI.fmiSetTime","page":"FMI version independent library functions","title":"FMI.fmiSetTime","text":"Set a time instant\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiSetContinuousStates","page":"FMI version independent library functions","title":"FMI.fmiSetContinuousStates","text":"Set a new (continuous) state vector\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiNewDiscreteStates","page":"FMI version independent library functions","title":"FMI.fmiNewDiscreteStates","text":"Returns the next discrete states\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiEnterContinuousTimeMode","page":"FMI version independent library functions","title":"FMI.fmiEnterContinuousTimeMode","text":"The model enters Continuous-Time Mode\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiCompletedIntegratorStep","page":"FMI version independent library functions","title":"FMI.fmiCompletedIntegratorStep","text":"This function must be called by the environment after every completed step\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetDerivatives","page":"FMI version independent library functions","title":"FMI.fmiGetDerivatives","text":"Compute state derivatives at the current time instant and for the current states\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetEventIndicators","page":"FMI version independent library functions","title":"FMI.fmiGetEventIndicators","text":"Returns the event indicators of the FMU\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetContinuousStates","page":"FMI version independent library functions","title":"FMI.fmiGetContinuousStates","text":"Return the new (continuous) state vector x\n\n\n\n\n\n","category":"function"},{"location":"library/library/#FMI.fmiGetNominalsOfContinuousStates","page":"FMI version independent library functions","title":"FMI.fmiGetNominalsOfContinuousStates","text":"Return the new (continuous) state vector x\n\n\n\n\n\n","category":"function"}]
}
